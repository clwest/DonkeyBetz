11
['Bolet ın de Matem aticas     Exploitability and Game Theory Optimal Play in '
 'Poker Jen Jingyu  Abstract When ﬁrst learning to play poker players are told '
 'to avoid betting outside the range of half pot to full pot to consider the '
 'pot odds implied odds fold equity from bluﬃng and the key concept of balance '
 'Any play outside of what is seen as standard can quickly give away a novice '
 'player But where did these standards come from and what happens when a '
 'player strays from standard play This paper will explore the key '
 'considerations of making game theory optimal GTO plays in headsup two player '
 'no limit Texas holdem To those new to the game it involves dealing two cards '
 'that are revealed only to the player they are dealt to hole cards and ﬁve '
 'community cards that are revealed with rounds of betting in between Hands '
 'are compared by looking at the highest ﬁve card poker hand that can be made '
 'with a players hole cards combined with the community cards This paper will '
 'focus on exploitative strategies and game theory optimal play in headsup '
 'poker based on examples of game scenarios from  Keywords Discrete math '
 'probability poker theory game theory Mathematics Subject Classiﬁcation '
 'Mathematics Subject Classiﬁcation According to AMS Recibido de  Aceptado '
 'de   Introduction Poker is a game that has been extensively studied from a '
 'mathematical stand point as it is interesting from a game theory standpoint '
 'and highlights con siderations that must be made when making decisions under '
 'uncertainty and  or Electrical Engineering and Computer Science '
 'Massachusetts Institute of Technology Cambridge MA US ajingyulimitedu',
 ' Jen Jingyu Li deals with expected value of strategies over time It is a '
 'game with strategies that are not immediately intuitive and the value of '
 'those strategies are only seen over a large number of hands To reduce '
 'complexity this paper will focus on headsup two player poker To those new to '
 'the game the game begins with each player being dealt two cards which are '
 'hidden from the other player A round of betting takes place where there are '
 'four actions available to the players check bet call raise A player can '
 'check or bet if no amount has yet been made in the current round of betting '
 'and a player can call match the amount bet by the opponent or raise bet an '
 'additional amount on top of op ponents bet if the opponent bets After the '
 'initial round of betting preﬂop the ﬁrst three community cards visible to '
 'both players come out ﬂop An other round of betting proceeds before the '
 'fourth card comes out and likewise before the ﬁfth and ﬁnal card After all '
 'cards are out there is one last round of betting before the players hands '
 'are compared showdown The complexity of poker arises from inferring '
 'probabilities through the many rounds of betting and making decisions that '
 'consider events in the future To understand the mathematics behind playing '
 'optimally we dissect the game into constrained subproblems but the concepts '
 'derived through these examples are relevant in real play  Pot Odds '
 'Deﬁnition  We refer to a made hand as a poker hand that is already '
 'guaranteed given a players hole cards and currently revealed community cards '
 'Deﬁnition  We refer to a draw as a hand that can be made given certain '
 'community cards come out Example  Suppose Alice has AAand Bob has   The '
 'community cards on theturn stage of game where  community cards have been '
 'revealed are  Alice has a made hand of a pair of aces and Alice has a draw '
 'to a straight Now if both players knew each others cards they would agree '
 'that if the last card is a  or  of any suit Bob wins otherwise Alice wins In '
 'this world of perfect information neither Alice nor Bob would bet on the '
 'river when the last card comes out because the winner would be clear Now '
 'suppose there is already  in the pot and Alice can either check Bolet ın de '
 'Matem aticas   ',
 'Exploitability and Game Theory Optimal Play in Poker  or bet before the '
 'river card comes out If Alice bets Bob has the option to reraise There are  '
 'hearts remaining in the deck which would give Bob a ﬂush beating Alice The '
 'remaining  cards would allow Bobs aces to hold Suppose Alice is to act ﬁrst '
 'Since Alice is favored to win the hand Alice has reason to bet here The '
 'amount she should bet is derived from calculating expected value EV The '
 'expected value is calculated as the probability of Alice winning the pot '
 'times the new pot amount deducted by the amount she bets Note that this '
 'calculation emphasizes that as soon as Alice places a bet she should no '
 'longer consider that money to be hers to lose but rather part of the pot '
 'that she can win sunk cost EA      Note that if the probability of winning '
 'here is less   it is not proﬁtable to bet This however is complicated when '
 'we consider a real game where both players do not have complete information '
 'and bluﬃng is a valid strategy Also note that Alices EV is strictly '
 'increasing as her bet increases ifBob always calls Bob however should only '
 'call if it is positive EV for him EB     Bob should thus only call if Alices '
 'bet is below around    the pot prebetting   what we refer to as pot odds It '
 'is important to keep in mind that Bob can call larger bets or even reraise '
 'because of something we refer to as implied odds which take into '
 'consideration further betting on the river due to it being unknown who has '
 'the better hand  Implied Odds Implied odds refer to the potential to make '
 'more money when a draw hits Remember that we previously assumed both players '
 'had complete information This is not true in a real game which means betting '
 'on the river can be proﬁtable In the case of our previous example Alice does '
 'not know what Bob Bolet ın de Matem aticas   ',
 ' Jen Jingyu Li has so if Bob hits his ﬂush he can potentially make more oﬀ '
 'Alice than was estimated by our EV calculations on the turn Example  Let us '
 'continue with our previous example If Bob hits a ﬂush on the river we will '
 'assume that he knows correctly that he has the better hand for now we will '
 'ignore the possibility Alice has a higher ﬂush because the probability is '
 'relatively low Suppose Alice bet  on the turn and Bob called The ﬁnal card '
 'comes  Now the pot is  and Alice acts ﬁrst Recall that the board currently '
 'shows  Now Alice doesnt know what Bob has and believes its likely he has top '
 'pair a king that pairs with the king showing on the board Alice thinks she '
 'can bet again to get value oﬀ of Bob Here Bob can fairly safely call or '
 'reraise Alices bet Lets look at what Alice should do when the river card '
 'comes out Suppose shes fairly certain Bob either hit his ﬂush or just has '
 'the top pair on the board Estimating the probabilities of these two cases is '
 'more complicated has to take into account what kinds of hands Bob generally '
 'plays and the history of actions on the current hand but its fair to assume '
 'Bob has more hands involving kings in his range than two hearts This means '
 'that if Bob knows Alice will bet on the river even if he hits his ﬂush he is '
 'willing to call larger bets from Alice on the turn or even reraise or bet if '
 'Alice checks Deﬁnition  We refer to a players range as the hands he plays in '
 'a given situation In general a players range does not change from hand to '
 'hand That is not to say that the player should be predictable see Section  '
 'regarding balancing range  Game Theory Optimal Strategies  Exploiting the '
 'Opponent In actuality the size of bets should not be proportional to how '
 'good your hand is nor should you only bet when you have a good hand as that '
 'is exploitable by the opponent over time In the previous sections we looked '
 'at examples constrained to a single hand in which case we only care about '
 'maximizing EV on that hand However poker is all about beating the odds over '
 'time so its Bolet ın de Matem aticas   ',
 'Exploitability and Game Theory Optimal Play in Poker  important to realize '
 'that a strategy optimized for a single hand may not be optimal or even '
 'proﬁtable in the long run As a simple but realistic example suppose your '
 'opponent only bets and raises hands that they think will win the pot but '
 'still calls some of your bets with weaker hands this is not an uncommon type '
 'of play from riskadverse beginners Its easy to exploit a player like this by '
 'simply using a strategy which folds to every bet or raise the opponent makes '
 'and still betting our good hands Of course eventually the opponent will '
 'catch on and counterexploit by bluﬃng their hands if they know we will fold '
 'On this end of the spectrum suppose a player bluﬀs too many hands To exploit '
 'this play style we can aﬀord to play a larger portion of hands and make '
 'large proﬁts when we hit a top hand This leads us to the idea of balancing '
 'our range or deciding the hands we play in a given situation such that an '
 'opponent cannot exploit our strategy  Balance To play nonexploitable game '
 'theory optimal GTO poker ranges should be balanced meaning Often this means '
 'that we have a variety of possible hands in the eyes of the opponent in any '
 'situation This means adding in a range of hands with which you bluﬀ and not '
 'betting only when you have a good hand or betting a larger amount when you '
 'have the winning hand Deﬁnition  We deﬁne defensive value as the expected '
 'value of a strat egy against the opponents most exploitative strategy Note '
 'the diﬀerence between this value and EV as weve previously looked at is that '
 'this assumes the opponent knows how we play and can exploit any patterns '
 'over time in our strategy A more rigorous deﬁnition of balanced strategy is '
 'minimizing the gap be tween defensive value Deﬁnition  and expected value In '
 'other words the expected payoﬀ of the strategy in a given hand should not '
 'change over time as your strategy is gradually exposed to your opponent your '
 'opponent plays the same way regardless whether your strategy is known to '
 'them Deﬁnition  Apure strategy dictates a players action in any situation ie '
 'the player will always make the same decision under given circumstances '
 'Bolet ın de Matem aticas   ',
 ' Jen Jingyu Li Deﬁnition  Amixed strategy is one in which the player assigns '
 'a prob ability distribution over all pure strategies Deﬁnition  Deﬁnition  '
 'Nash equilibrium is a strategy set in a multiplayer game where neither '
 'player alone can increase their payoﬀ Because of this it is a stable point '
 'where neither player wants to deviate from their current strategy Deﬁnition  '
 'A game in which the sum of all players scores is equal to  is called a '
 'zerosum game Deﬁnition  Indiﬀerence refers to a game state where a player '
 'gets the same expected payoﬀ regardless what strategy is chosen Deﬁnition  '
 'Anindiﬀerence threshold is a value for a parameter that a player can choose '
 'to force indiﬀerence Deﬁnition  on the opponent It is a known fact of game '
 'theory that all multiplayer games with ﬁnite payout matrices have at least '
 'one Nash equilibrium Deﬁnition  Addition ally poker is a zerosum game '
 'Deﬁnition  and it is known that all zerosum twoplayer games have an optimal '
 'strategy as long as mixed strategies Deﬁni tion  are allowed This leads to '
 'the concept of indiﬀerence Deﬁnition  By setting expected payoﬀ equations '
 'equal to each other we can obtain val ues for parameters that force a player '
 'to be indiﬀerent to choosing among strategies The value of the parameter '
 'found by solving these equations is an indiﬀerence threshold Deﬁnition  Let '
 'us take a look at the following example Example  Suppose Bob has three of a '
 'kind and on a particular board is only scared of Alice having a ﬂush Let us '
 'assume that Alice has a ﬂush here  of the time How often can Alice bluﬀ For '
 'this example suppose there is  in the pot and Alice can choose to bet a ﬁxed '
 'amount of  To keep it simple we will say Bob either calls or folds when '
 'Alice bets How often should Alice bluﬀ here If Alice bets  Bob can pay  to '
 'potentially win  Suppose Alice only bets when she has the ﬂush Bob can '
 'exploit this strategy by folding every time Bob bets preventing him from '
 'getting any additional value from hitting his ﬂush and taking the pot  of '
 'the time Alice has a defensive value of    with this strategy where she only '
 'proﬁts when she has the ﬂush Now suppose Alice bets all her Bolet ın de '
 'Matem aticas   ',
 'Exploitability and Game Theory Optimal Play in Poker  hands here  of the '
 'time she has the ﬂush and the other  of the time she has nothing If Bob '
 'calls his EV is    and if he folds his EV is  so Bob will exploit Alices '
 'strategy here by always calling The defensive value of Alices strategy is    '
 'The two strategies mentioned so far always checking a dead hand and always '
 'betting a dead hand are what are known as pure strategies Deﬁni tion  and '
 'neither is optimal for Alice in this situation We know this because both are '
 'exploitable Bob alone can change his strategy and increase his payoﬀ This '
 'indicates we are not at a equilibrium point Now we explore mixed strategies '
 'Let PAbluﬀbe faction of all hands Alice has on the river that she bluﬀs with '
 'Bobs EV for calling when Alice bets can be computed as EBBcallPAbluﬀ   '
 'Alternatively Bob can fold when Alice bets EBBfold  Alices EV can be '
 'computed as    EABfold   Alices strategy is least exploitable when Bobs EV '
 'for calling and folding are equal ie Bob is not able to change his strategy '
 'to exploit Alice even if over time he ﬁgures out how often Alice bluﬀs By '
 'setting EBBcall EBBfold we can solve for Alices optimal bluﬀ frequency such '
 'that Bob is indiﬀerent to calling versus folding It turns out that it is '
 'optimal for Alice to bluﬀ around  of her hands Example  Consider the general '
 'scenario where we only have one round of betting the pot has B bets Alice '
 'can make a bet of size  and Bob can call or fold if Alice bets The payout '
 'matrix is as follows Bolet ın de Matem aticas   ',
 ' Jen Jingyu Li Bob Checkcall Checkfold Alice Winning hand Bet P  P Check P P '
 'Dead hand Bet  P Check   As we can see from the payout matrix it is always '
 'in Alices favor to bet when she has a winning hand It is less obvious what '
 'Alice should do when she has a dead hand Depending on Bobs calling versus '
 'folding frequency it can be beneﬁcial for Alice to bluﬀ a percentage of her '
 'dead hands According to the concept of indiﬀerence Alice wants to choose a '
 'bluﬃng frequency such that Bobs EV for calling is equal to his EV for '
 'folding Let b representbluﬀs bluﬀsvalue bets EBcallbP  EBfold  We have '
 'EBcall EBfold when  P  Likewise Bob should choose a calling frequency such '
 'that Alice is indiﬀerent to checking versus bluﬃng her dead hands Let cbe '
 'the frequency with which Bob calls EAcheck  EAbluﬀ   By setting these two '
 'EVs equal to each other we ﬁnd the value cwith which Bob should call when '
 'Alice bets cP P  It turns out these two quantities are quite useful so we '
 'will give the quantity   own letter α Alices optimal bluﬀ to bet ratio is '
 'equal to αand Bobs optimal calling frequency is equal to  α Bolet ın de '
 'Matem aticas   ',
 'Exploitability and Game Theory Optimal Play in Poker  This can be '
 'generalized to diﬀerent bet sizes Bets are generally thought about as a '
 'fraction of the pot according to pot odds Suppose Alice can bet any fraction '
 'of the pot xP bxP PxP x  x  Multistreet Games Thus far we have mainly '
 'discussed single street one round of action scenarios but in reality action '
 'on a given street depends on everything that has happened before In Example  '
 'we assumed that Alice has a ﬂush  of the time In reality this probability '
 'depends on everything that happened before the river Example  Lets set up '
 'the following scenario The board shows  Alice has a pair of aces Bob has a '
 'hand from a distribution which   with two hearts   hands The pot contains  '
 'and players can either check or bet  Alice is ﬁrst to act Bob is conﬁdent he '
 'has the winning hand if he hits his ﬂush and a dead hand otherwise The ﬂush '
 'comes around  of the time in actuality its a little less but for simplicitys '
 'sake we will use  From what we studied before Alice should bet and Bob '
 'should call if he has the odds Note that implied odds should be considered '
 'here rather than just pot odds because Bob can get more value on the river '
 'by hitting his ﬂush Assume Alice and Bob make it to the river and now there '
 'is  in the pot Alice bets on the turn and Bob calls Now Alice has no reason '
 'to bet here Bolet ın de Matem aticas   ',
 ' Jen Jingyu Li because we have assumed Bob knows whether he has the winning '
 'hand at this point Thus Alice checks and Bob can choose to either bet or '
 'check According to Example  Bob should bluﬀ with   many hands as she value '
 'bets with and Alice should call with a frequency of    However this is '
 'actually incorrect because our prior calculations relied on a single street '
 'game Consider how this situation is diﬀerent Suppose Bob wants to bluﬀ on '
 'the river This means he had to have called Alices bet on the turn with a '
 'dead hand Also note that Bob can only bluﬀ on the river if a heart comes out '
 'Thus in this multistreet game Alice should be considering indiﬀerence of Bob '
 'folding versus playing a dead hand through both streets Letcbe Alices '
 'optimal calling frequency on the river EBdead handfold  EBdead '
 'handplayPﬂushPAlice  PﬂushPAlice  Pno       So we see that it turns out '
 'Alices optimal calling frequency is   rather   analysis of a single street '
 'game By analyzing a single street game we are able to reason about '
 'strategies but the determined frequencies cannot be blindly applied to '
 'multistreet games where there are added layers of complexity  Conclusion GTO '
 'strategy explores the concepts of balance and indiﬀerence which min imizes '
 'exploitability When you have minimal knowledge of the opponents play style '
 'it is a good defensive strategy to play close to GTO which aims to optimize '
 'for the worst case by minimizing your own exploitability GTO strat egy '
 'assumes an opponent who also plays optimally or knows how to exploit '
 'weaknesses in any strategy However the assumption that the opponent is '
 'always perfectly rational and plays according to GTO strategy is rarely true '
 'and the discrepancy is what Bolet ın de Matem aticas   ',
 'Exploitability and Game Theory Optimal Play in Poker  allows players who '
 'know how to take advantage proﬁt Even good players do not play a perfectly '
 'balanced game and open themselves up to exploitability in which case it is '
 'beneﬁcial to play to their weaknesses whenever you have the information to '
 'do so To play exploitative poker it is important to consider past '
 'information about the opponents overall play style ranges and strategy as '
 'well as what actions took place on earlier streets of a given hand However '
 'keep in mind that strategies that stray too far from GTO can be '
 'counterexploited Suppose we have two perfectly rational players who start oﬀ '
 'with very diﬀerent exploitable strategies In theory over time the two '
 'players would learn to exploit and counterexploit each others strategies and '
 'eventually their strategies would converge to near GTO In conclusion '
 'depending on the opponent playing GTO may not always be the most proﬁtable '
 'but it minimizes exploitability making it a safe strategy to play against '
 'any opponent References  Bill Chen and Jerrod Ankenman The mathematics of '
 'poker ConJelCo  Bolet ın de Matem aticas   ']
16
['Approximating GameTheor eticOptimalStrategies forFullscale Poker '
 'DBillingsNBurchADavidsonRHolteJSchaefferTSchauenbergandDSzafron Department '
 'ofComputing ScienceUniversityofAlberta  Email darseburchdavidsonho '
 'ltejonathanterenceduanecsualbertaca Abstract Thecompu tation oftheﬁrst comp '
 'leteappro xima tions ofgametheor eticoptim alstrate gies forfull scale '
 'pokerisaddre ssed Severalabstraction tech niques arecomb ined torepre sent '
 'thegame  player TexasHoldem having size using closely related modelseach '
 'havingsize Despite thereductio ninsize byafactor  billion theresulting '
 'models retain thekeyprop erties andstructur eoftherealgameLinear pro gramm '
 'ingsolutions totheabstracted gameareused tocreate substantially impro '
 'vedpokerplaying pro grams able todefeat strong human players andbe compe '
 'titiveagainstworldc lassopponents  Mathematica lgame theory wasintrod uced '
 'byJohn vonNeu mann  become oneofthefounda tions ofmoder necono mics '
 'vonNeumann andMorgenstern  VonNeuman nused thegameofpokerasabasic mode  '
 'zerosum adversarial gamesandproved theﬁrstfundamenta lresult '
 'thefamousminimax theor emA fewyears laterJohn Nash added results for playe '
 'rnon coop erativegames forwhich helater wontheNobel Prize Nash  problems '
 'canbemodeled using game theory andithasbeen emplo yedinawide variety of doma '
 'insinrecent years Ofparticu larinterest istheexistence ofoptima lsolutions '
 'orNash equilibria Anoptima lsolution provides arandom ized mixedstrate '
 'gybasically arecipe ofhowtoplay ineach possible situation Using thisstrate '
 'gyensures thatanagent willobtain atleast thegame theoretic value ofthegame '
 're gardless oftheoppo nent sstrate gyUnfortu nately ﬁndin g exact optima '
 'lsolutions islimited torelati velysmall problem sizes andisnotpractical '
 'formost realdomain s This paperexplorestheuseofhighly abstracted mathem at '
 'icalmodels which capture themost essential prope rties ofthe realdomainsuch '
 'thatanexact solution tothesmaller prob lemprovides auseful appro ximation '
 'ofanoptimal strate gy fortherealdoma inTheapplication domain used isthegame '
 'ofpokerspeciﬁcally TexasHold emthemost popularform ofcasino '
 'pokerandthepokervariant used todeterm inethe worldcham pion attheannu '
 'alWorldSeries ofPokerDuetothecompu tational limitations involvedonly simpli '
 'ﬁedpokervariation shavebeen solvedinthepastegKuhn  Sakagu chiandSakai  While '
 'these areofthe oretical interest thesame metho dsarenotfeasible forreal game '
 'swhich aretoolargebymanyordersofmagnitud e Koller  Shi and Littman  '
 'investiga tedabstraction tech nique storeducethelargesearch space andcomp '
 'lexityofthe problem using asimpliﬁed variantofpokerTakusaga wa  created '
 'nearoptimal strate gies fortheplay ofthree speciﬁc Hold emﬂops andbetting '
 'sequence sSelby  comp uted anoptimal solution fortheabbreviated game of '
 'preﬂop Holde m Using newabstraction techniqu eswehaveprodu cedvi able pseud '
 'ooptimal strate gies forthegame  er TexasHold em Theresulting pokerplaying '
 'programs have demo nstrated atremen dous improvementinperformanc e Whereas '
 'thepreviousbestpokerprogr amswere easily beaten byanycomp etent human player '
 'thenewprograms arecapa bleofdefeating verystrong players andcanhold their '
 'own again stworldclass oppo sition Althoug hsome domain speciﬁc knowled '
 'geisanasset in creating accurate reducedscale modelsanalogo usmetho ds '
 'canbedevelopedformanyother imper fectinformation do mains andgeneralized '
 'game trees Wedescrib eageneral method ofproblem refor mulation thatperm '
 'itstheindepen dent solution ofsubtrees byestimating thecondition alprob '
 'abilities neededasinput foreach compu tation This paper '
 'makesthefollowingcontrib utions  techniqu esthat can reducean ',
 'abilities neededasinput foreach compu tation This paper '
 'makesthefollowingcontrib utions  techniqu esthat can reducean pokersearch '
 'space toamanag eable without losing themost importan tproperties ofthegame  '
 'progr amthatisamajor impro vement overprevious efforts andiscapable '
 'ofcompetin gwith worldc lassopposition  Game theory encompasses allforms '
 'ofcomp etition between twoormore agents Unlik echess orcheck erspokerisa '
 'game ofimperfect information andchanceoutco mesItcan berepre sented with '
 'animperfect information game treehav ingchance nodesanddecision nodes which '
 'aregroup edinto information sets',
 'Since thenodesinthistreearenotindepe ndent divide andc onqu ermethod '
 'sforcompu ting subtr eessuch asthe alpha beta algorith marenotapplicable '
 'Foramore detailed descriptio nofimperfect infor mation game treestructure '
 'see Koller  Astrategyisasetofrules forchoosing anaction atev erydecision '
 'node ofthetree Ingener althiswillbearan domized mixed strategywhich '
 'isaprobability distrib ution overthevariou salternati vesAplayermust '
 'usethesame pol icyacross allnodes inthesame infor mation setsince from '
 'thatplayer sperspecti vetheyareindistinguisha blefromeach other '
 'differingonly inthehidden infor mation comp onen t Theconvention almetho '
 'dforsolving such aproblemisto convertthedescripti verepresentatio '
 'norextensive form into asystem oflinear equation swhich isthen solvedbyalin '
 'earprogrammin gLP system such astheSimple xalgorithm The optimal solution '
 'sarecomp uted simultaneou slyforall player sensur ingthebestworstcase outco '
 'meforeach player Tradition allytheconversion tonormal form wasaccom panied '
 'byanexponential blowupinthesize oftheprob lem meanin gthatonly verysmall '
 'problem instances could besolvedinpractice Koller  describe danalter nate '
 'LPrepresen tation called sequen ceform which exploits thecomm onproperty '
 'ofperfect recall wherein allplayers knowtheprece ding history ofthegame '
 'toobtain asystem ofequation sandunkn owns thatisonly linear inthesize of '
 'thegametree This exponential reductio ninrepresentation hasreopened '
 'thepossibility ofusing game theoretic analy sisformanydoma ins Howeversince '
 'thegametreeitself canbeverylargetheLPsolution metho disstilllimited to mode '
 'rateproble msizes norm allylessthan abillion nodes  Agame orhand '
 'ofTexasHoldem consists offourstages each followedbyaroundofbetting Preﬂop '
 'Each player isdealt twoprivatecards facedown thehole cards Flop Three '
 'community cardsshare dbyallplayers are dealt faceup TurnAsingle comm unity '
 'card isdealt faceup RiverAﬁnal commu nitycard isdealt faceup After '
 'thebetting allactiveplayers revealtheir hole cards fortheshowdown Theplayer '
 'with thebest ﬁvecard poker hand form edfrom their twoprivatecards '
 'andtheﬁvepublic cards wins allthemone ywagered ties arepossible The game '
 'starts offwith twoforced bets the blinds put intothepotWhen itisaplayer '
 'sturn toacttheymust ei therbetr aiseincrease their investmen '
 'tinthepotcheckcall match what theopponent hasbetorraised orfoldquitand '
 'surren derallmone ycontributed tothepot Thebestkno wnnoncomm ercial '
 'TexasHoldem program isPokiIthasbeen playing onlin esince  andhasearne d '
 'animpressi vewinning record albeit againstgener allyweak oppo sition '
 'Billings  system sabilities arebased onenum eration andsimulation techn '
 'iques expert knowledge andoppo nent mode ling The programsweak nesses '
 'areeasily exploited bystrong players especially in  ergame Figure  factors '
 'forHoldem andabstraction s  TexasHold emhasaneasily identiﬁab lestructure '
 'alternat ingbetween chanc enodesandbetting roundsinfourdistinct stages Ahigh '
 'levelviewoftheimperfec tinfor mation game treeisshowninFigure  Holdem '
 'canbereformulated toproducesimilar butmuch smaller gamesThe objecti '
 'veistoreducethescale ofthe problemwithout severely altering thefundamental '
 'structu re ofthegame ortheresulting optimal strate gies Thereare '
 'manywaysofdoing this varyin gintheoverallreductio nand intheaccur '
 'acyoftheresulting approx imation Some ofthemost accurate abstractio '
 'nsinclude suitequiv alence isomorphisms offering areductio nofatmost afactor '
 'of rankequivalen ceonlyunder certain cond itions andranknearequiv alence '
 'Theoptimal solutions tothese ab stracted problems willeither beexactly '
 'thesame orwillhave asmall bounded errorwhich werefer toasnearoptimal so '
 'lutions Unfortu nately theabstraction swhich produ ceanex '
 'actornearexactreform ulation donotproduce theverylarge',
 'asmall bounded errorwhich werefer toasnearoptimal so lutions Unfortu nately '
 'theabstraction swhich produ ceanex actornearexactreform ulation donotproduce '
 'theverylarge reduc tions requiredtomakefullscale pokertractable Acommon '
 'metho dforcontro lling thegame size isdeck reduction Using lessthan '
 'thestandard  greatly reduc esthebranch ingfactor atchanc enodesOther metho '
 'ds include reducin gthenumb erofcards inaplayer shandeg from  hand  '
 'handandreducing thenum berofboardcards  aswasdone byShi andLittman  '
 'forthegame ofRhod eIsland Hold em Koller  such parame terstogenera tea wide '
 'variety oftractable gamestosolvewith their Gala sys tem Wehaveused anumb '
 'erofsmall andintermed iatesized game srangingfrom eight cards twosuits four '
 'ranks  cards three suits eightranksforthepurpo seofstudyin g abstraction '
 'method scompar ingtheresults with knownexact ornearoptimal solutions '
 'Howeverthese smaller games are notsuitable foruseasanappro ximation '
 'forTexasHoldem astheunder lying structur esofthegames aredifferent To '
 'producegood playing strate giesforfullscale pokerwelook forabstraction '
 'softherealgamewhich donotalter thatbasic',
 'structure The abstraction techniq uesused inpractice arepowerful interms '
 'ofreduc ingtheproblem size andsubsume those previously mentio ned '
 'Howeversince theyarealso much crude rwecalltheir solution spseudo optimal '
 'toemph asize thatthere isnoguara ntee thattheresulting appro ximations '
 'willbeaccur ateorevenreason able Some willbelowrisk propositions while '
 'others willrequire empirical testing tode termine iftheyhavemerit  Betting '
 'round reduction Thestandard rules oflimit Holde mallowforamaximu mof four '
 'bets perplaye  erlimit poker there  betting sequen cesofwhich twodonot '
 'occur    fold leading toaterminal node inthegametree  inacallcarry ingforw '
 'ardtothenextchancenode Using andcapital letters forthesecond player '
 'thetreeofpossible betting sequences foreach roundis '
 'kKkBfkBckBrFkBrCkBrRfkBrRckBrRrFkBrRrC bFbCbRfbRcbRrFbRrCbRrRfbRrRc '
 'Wecallthislocal collection ofdecision nodesabetting treeandrepresen '
 'titdiagram atically with atriangle Withbetting round reduction each '
 'playerisallowed a maximu mofthree betsperroundthereb yeliminatin gthelast '
 'twosequen cesineach line Theeffectivebranc hing factor of thebetting '
 'treeisreducedfrom nine tosevenThis does not appear tohaveasubstantial '
 'effectonplayorontheexpecte d valueEV foreach player This obser vation '
 'hasbeen veriﬁed experimentally Incontrast wecompu tedthecorresp ondin g '
 'postﬂop modelswith amaximu moftwobets perplayer per roundandfoundradical '
 'changestotheoptimal strate gies strongly suggesting '
 'thatthatlevelofabstraction isnotsafe  Elimination ofbetting rounds '
 'Largereductio nsinthesizeofapokergame treecanbeob tained byelimination '
 'ofbetting rounds Thereareseveral waystodothis andtheygenera '
 'llyhaveasigniﬁcant impact onthenature ofthegameFirst thegamemay betruncated '
 'byeliminating thelastroundorroundsInHold emignor ingthelastboard card '
 'andtheﬁnal betting roundproduces a  loftheactual  to  ndmodelloses some '
 'ofthesubtlety involvedinthe trueoptimal strate gybutthedegradation applies '
 'primarily to advancedtactics ontheturnThere isasmaller effectonthe ﬂopstrate '
 'gyandthestrate gyfortheﬁrstbetting roundmay havenosigniﬁcant chang essince '
 'itincorp orates alltheout comes oftwofuture betting roundsWeusethisparticu '
 'lar abstraction todeﬁne anappropriate strate gyforplay inthe '
 'ﬁrstroundandthus callitapreﬂop model seeFigure   raiseswhenonlytwoplayersare '
 'involvedHoweveroccasionswithmorethanthreelegitimateraises '
 'arerelativelyrareanddonotgreatlyalteranoptimalstrategy  '
 'aplayermayfoldeventhoughthereisnooutstand ingbetThisislogically dominated '
 'bynotfoldingandtherefore '
 'doesnotoccurinanoptimalstrategyandisalmostneverseenin practiceThe '
 'effectoftrunc ation canbelessened throughtheuse ofexpected value leaf nodes '
 'Instead ofending thegame abrup tlyandawardin gthepottothestrong esthand '
 'atthat momen twecomp uteanaverageconclusion overallpossible chance outcom  '
 'model endin gontheturn werollout  rivercards assuming nofurth er betting '
 'oralternately assuming onebetperplayerforthe lastroundEach player isawarded '
 'afractio nofthepotcor respon ding totheir probability ofwinning thehand  '
 'roundpreﬂop modelwerollo  comb inations oftheturnandriver Themost extreme '
 'form oftrunca tionresults  mode lwith noforesight offuturebetting rounds '
 'Since each futur eroundprovidesareﬁnemen ttotheappro ximation this will '
 'notreﬂect acorrect strate gyfortherealgameInpar ticular betting plans '
 'thatextend overmorethan oneround such asdeferrin gtheraise ofaverystrong '
 'hand arelost entirely Nevertheless eventhese simplistic mode lscanbe useful '
 'when combin edwith expected value leafnode s AlexSelby comp uted anoptimal '
 'solution forthegame of',
 'entirely Nevertheless eventhese simplistic mode lscanbe useful when combin '
 'edwith expected value leafnode s AlexSelby comp uted anoptimal solution '
 'forthegame of preﬂop Holdem which consists ofonly theﬁrstbetting round '
 'followed byanEVrollo utoftheﬁveboardcards todeter mine thewinner Selby  '
 'hthere aresome se rious limitations inthestrate gybased  ndmodel wehaveincor '
 'porated theSelby preﬂo psystem intooneofour programs  asdescrib edlater '
 'inthissection Incontra sttotrunca ting roundswecanbypass certain early '
 'stages ofthegameWefrequ ently usepostﬂo pmod elswhich ignore thepreﬂop '
 'betting roundanduseasingle ﬁxedﬂopofthree cards seeFigure  Itisnatura '
 'ltoconside rtheidea ofindep enden tbetting rounds where each phase '
 'ofthegameistreated inisolation Unfor tunately thebetting history '
 'fromprevious roundswill almost alwaysconta inconte xtualinfor mation '
 'thatiscritical tomaking appropriate decision sTheprobability distrib ution '
 'overthehandsforeach player isstrong lydepend entonthe path '
 'thatledtothatdecision point soitcanno tbeignore d without risking aconsid '
 'erable lossofinfor mation However thenaiveindepen dence assumption '
 'canbeviable incertain circumstan ces andwedoimplicitly useitinthedesign of  '
 'tobridg ethegapbetween  ndpreﬂop model  model Anothe rpossible abstraction '
 'weexploredwasmerging two ormore roundsintoasingle round such ascreating acom '
 'bined  turnr iverHoweveritisnotclear what theap propriate betsizeshould '
 'beforthiscomp osite roundInany case thesolution sforthese mode '
 'lsoverafullrange ofpossi blebetsizes allturned outtobesubstantially '
 'different from their  coun terparts andthemethod wastheref orere jected  '
 'Composition ofpreﬂop andpostﬂop models Althoug hthenodes ofanimperfect '
 'information gametreeare notindepen dent ingeneral some decomp osition '
 'ispossible Forexample thesubtrees resulting fromdifferen tpreﬂo p betting '
 'sequenc escannolongerhavenodes thatbelong tothe',
 'same information  eesforourpostﬂop models canbecomp uted inisolation '
 'provided thattheappropriate preco nditions aregivenasinput Unfortu nately '
 'knowingthe correc tconditio nalprobabilities would norm allyentail solv '
 'ingthewhole game sothere would benoadvantage tothe decom position Forsimple '
 'postﬂop modelswedispense with theprior probabilities Forthepostﬂop '
 'modelsused  and  wesimply ignoretheimplication softhepreﬂo p betting actions '
 'andassume auniform distrib ution overall possible hands foreach player '
 'Differen tpostﬂop solutions were comp uted forinitial potsizes '
 'oftwofoursixandeight betscorr espondin gtopreﬂop sequen ceswith zero one two '
 'orthree raises butignor ingwhic hplayer initially made each raise  '
 'thefourpostﬂop solution saresimply ap pend edtotheSelby preﬂo pstrate '
 'gyFigur  h these simplify ingassumptio nsaretechnically wron gthere sulting '
 'play isstillsurprising lyeffective Abetter waytocomp osepostﬂop models '
 'istoestimate thecond itional probabilities using thesolution toapreﬂo p mode '
 'lWithatractable preﬂop modelwehaveamean sof estimating anappro priate strate '
 'gyattherootandthereby de termine theconsequent probability distrib ution s   '
 'preﬂop model wasdesign edand solved The resulting pseud ooptimal strate '
 'gyforthepre ﬂop which wassigniﬁcan tlydifferent from theSelby strat '
 'egywasused todeterm inethecorre spondin gdistrib utionof hand sforeach playe '
 'rineach conte xtThis provided thenec essary input paramete rsforeach '
 'ofthesevenpreﬂo pbetting sequenc esthat carry overtotheﬂop stage Since each '
 'of these postﬂop mode lshasbeen givenanapproximatio nof theperfect recall '
 'knowledge ofthefullgametheyarefully comp atible with each other '
 'andareproperly integrated un dertheumbr ellaofthepreﬂop modelFigure  '
 'thisshould beequivalenttocomp uting themuch largertree butitislimited '
 'bytheaccurac yandappropriaten essofthe proposed preﬂop betting model  '
 'Abstractio nbybucketing Themost impor tantmetho dofabstraction forthecompu '
 'ta tionofourpseudo optimal strate giesiscalled bucketing This isanextensio '
 'nofthenaturalandintuiti veconcep tthathas been applied manytimes inprevious '
 'research egSklansk y andMalmuth    Thesetofallpossible hand sispartitio '
 'nedintoequiv alence classes also called bucketsorbinsAmanyto one mapp '
 'ingfunction determin eswhich hand swill begrouped togethe rIdeally thehand '
 'sshould begrouped accordin gto strategicsimilarity mean '
 'ingthattheycanallbeplayed ina similar manner without much lossinEV '
 'Ifeveryhandwasplayed with aparticu larpurestrategy ieonly oneoftheavailable '
 'choice sthen aperfectmappin g functio nwould groupallhands thatfollowthesame '
 'plan and  allthecardsknowntothatplayerandthefullpaththatledtothat '
 'nodeNodeswithidenticallabelsdifferonlyinthehiddeninforma tionandaretherefore '
 'inthesameinformation setSincethebetting historyisdifferentforthesesubtrees '
 'noneofthenodesareinter dependent Figure     foreach player would besufﬁcient '
 'for each betting roundHoweversince amixed strategymay be indicated foroptim '
 'alplay insome cases wewould liketo grouphand sthathaveasimilar probability '
 'distrib utionover action plans Oneobviousbutrathe rcrude bucketing function '
 'istogroup allhand saccor ding tostrength ieitsrankwith respect toall '
 'possible hands ortheprobability ofcurre ntly being inthe lead This '
 'canbeimpro vedbyconside ringtherollou tofall futur ecards giving anunweigh '
 'ted estimate ofthechance ofwinning thehand Howeverthis isonly aonedimensio '
 'nalviewofhand types inwhat canbeconsidered tobeandimensional space ofstrate '
 'gies with avastnumberofdifferent ways toclassify them Asuperio rpractical '
 'metho dwould beto projec tthesetofallhand sonto atwodimensional space con',
 'space ofstrate gies with avastnumberofdifferent ways toclassify them '
 'Asuperio rpractical metho dwould beto projec tthesetofallhand sonto '
 'atwodimensional space con sisting ofrollout hand strength andhand poten '
 'tialsim ilartothehand assessment used inPokiBillings etal  Clusters '
 'intheresulting scatter gramsuggest reason able groupsofhand stobetreated '
 'similarly Weeventually settled onasimple comp romise With available '
 'bucketsweallocate torollout hand strength The numberofhand types ineach '
 'class isnotunifo rmthe classes forthestrong esthandsaresmaller than those '
 'for medioc reandweak hands allowing forbetter discriminatio n ofthesmaller '
 'fractions ofhand sthatshould beraised orre raised One special '
 'bucketisdesignated forhands thatarelowin strength buthavehigh poten tialsuch '
 'asgooddrawstoaﬂush orstraight This plays animportan troleinidentif ying good '
 'hand stouseforblufﬁngknownassemibluf fsinSklansk y andMalmuth  Compar '
 'ingpostﬂop solutions thatuse sixstrength bucketstosolutions with ﬁvestreng '
 'thplus one high potential bucketweseethatmost bluffsinthelatter are '
 'takenfromthespecial bucketwhich issometime splayed in thesame wayasthestrong '
 'estbucketThis conﬁrm edour expectations thatthehighp otential bucketwould '
 'impro vethe selection ofhands forvariousbetting tactics andincrea sethe '
 'overallEV',
 'Figure  probabilities sixbucketsperplayer Thenumberofbucketsthatcanbeused '
 'inconju nction with  ndmodel isverysmall typically sixorsevenforeach player  '
 'ofbucketassignmen tsObviously thisresults inaverycoarsegr ained abstract '
 'game butitmay notbesubstantially differen tfrom thenumb erofdistinctions '
 'anaveragehuman player migh tmakeRegardle ssitisthe best wecancurre '
 'ntlydogiventhecomp utational constraints ofthisapproach Theﬁnal thing neede '
 'dtosevertheabstract gamefrom the unde rlying realgametreearethetransition '
 'probab ilities The chance nodebetween theﬂopandturnrepresen tsaparticu lar '
 'card being dealt from theremainin gstock  Inthe abstract game there '
 'arenocards only bucketsTheeffectof theturncard intheabstract game '
 'istodictate theprobability ofmovingfrom onepairofbucketsontheﬂoptoanypairof '
 'bucketsontheturn Thus thecollection ofchance nodes in thegametreeisrepresen '
 'tedbyan to tran sition netw orkasshowninFigure  models thiscanbeestimated '
 'bywalking theentire tree enum erating alltransitions forasmall numbe '
 'rofcharacter istic ﬂops For preﬂop models thefullenumer ation ismore '
 'expensiveen comp assing all possible ﬂops soit isestimated either bysampling '
 'orbypara llel enum eration ofatruncated tree  postﬂop model wecancomfor '
 'tably solve abstract games with uptosevenbucketsforeach player in each '
 'roundChang ingthedistrib ution ofbucketssuch assix fortheﬂop sevenfortheturn '
 'andeight fortheriverdoes notappeartosigniﬁcantly affectthequality '
 'ofthesolutions better orworse Theﬁnal linear programmin gsolution produ '
 'cesalargeta bleofmixedstrate gies probabilities forfoldcall orraise '
 'foreveryreacha blescenario intheabstract game Tousethis thepokerplayin '
 'gprogramlooksforthecorrespo nding situa tionbased onthesame hand strength '
 'andpotential measures andrandomly selects anaction from themixedstrate gy '
 'The largeLPcompu tations typically takelessthan aday using CPLEX with '
 'thebarriermethod anduseuptotwo Gigab ytes ofRAM Largerproblems will exceed '
 'available memor ywhich iscomm onforlargeLPsystems Certain LPtechniq uessuch '
 'asconstr aintgenerationcould poten tially extend therangeofsolvable '
 'instances considera blybutthis would proba blyonly '
 'allowtheuseofoneortwoaddition al bucketsperplaye   Testing against computer '
 'players Aseries ofmatches between compu terprograms wascon ducted with '
 'theresults showninTable  aremea sured insmall betsperhand sbh Each match '
 'wasrunforat least    cases The variance pergamedepend sgreatly onthestyles '
 'ofthe twoplayer sinvolvedbutistypically  d deviatio nforeach match outco '
 'meisnotshownbutisnor mally lessthan  sbh Thebot playe rswere  comp osed '
 'ofahand crafted  preﬂo p mode lproviding cond itional probability distrib '
 'utions toeach  models Figur  in thisprototype used sixbucketsperplayer '
 'perround  compo sedoffour  ndpostﬂop modelsun derthenaiveuniform distrib '
 'ution assumption with  etsperplayer perroundSelby soptimal solution '
 'forpreﬂop Holdem isused toplay thepreﬂo pSelby   comp osed ofasingle  '
 'postﬂop model wrong lyassuming unifo rmdistrib ution sandaninitial potsize '
 'oftwobets with sevenbucketsperplayer perroundThis program used analwayscall '
 'polic yforthepreﬂop betting round PokitheUniversityofAlberta pokerprogr '
 'amThis older version ofPokiwasnotdesigned toplay  ergame andcanbedefea '
 'tedrather easily butisauseful benchm ark AntiPokiaruleb ased programdesigned '
 'tobeat Pokiby exploiting itsweaknesses andvulnerabilities  er game '
 'Anyspeciﬁc coun terstrate gycanbeevenmore vul nerab letoadapti veplayers '
 'Aadaptiarelati velysimple adaptiveplaye rcapable of slowlylearning '
 'andexploiting persistent pattern sinplay',
 'game Anyspeciﬁc coun terstrate gycanbeevenmore vul nerab letoadapti '
 'veplayers Aadaptiarelati velysimple adaptiveplaye rcapable of slowlylearning '
 'andexploiting persistent pattern sinplay AlwaysCallaveryweak benchmark '
 'strate gy AlwaysRaise averyweak benchmark strate gy Itisimpor tanttounder '
 'stand thatagame theoretic optimal player isinprinc iple notdesigned '
 'towinItspurpo seisto notloseAnimplicit assumptio nisthattheopponent isalso '
 'playing optimally andnothing canbegained byobser ving theoppo nent '
 'forpattern sorweaknesses Inasimple gamelikeRoShamBo also knownasRock '
 'PaperScissors playin gtheoptim alstrate gyensures abreak evenresult '
 'regardless ofwhat theoppo nent does and is therefo reinsuf ﬁcien ttodefeat '
 'weak opponents ortowina tourn ament Billings  lexand intheor yanoptim '
 'alplayercanwin butonly iftheoppo nent makesdomina tederrorsAnytime aplaye '
 'rmakesany choice thatispart ofarando mized mixedstrate gyofsome game '
 'theoretic optimal polic ythatdecision isnotdominated Inother words '
 'itispossible toplay inahighlysubop timal mann erbutstill break evenagainst '
 'anoptimal player be cause those choices arenotstrictly domin ated Since '
 'thepseudo optimal strate giesdonooppo nent model ingthere isnoguarantee '
 'thattheywillbeespecially effective again stverybadorhighlypredicta '
 'bleplayers Theymust rely only onthese fundamental strate gicerror '
 'sandthemarginof victory might berelati velymodestasaresult',
 'NoProgram                                                                         '
 'X Table  tervscompu termatche ssbh Thecritical question iswheth ersuch '
 'errors arecommo nin practice There isnodeﬁniti veanswer tothisquestion yet '
 'butprelimin aryevidence sugge ststhatdomin ated error soc curoften enoug '
 'htogain ameasur able EVadvantage over weak erplayers butmay notbeverycommo '
 'nintheplay of verygood player s Theﬁrsttests oftheviability ofpseudo optimal '
 'solutions were done with  playin gpostﬂo pHoldem where both playe rsagree '
 'tosimply call inthepreﬂop thereb y matchin gtheexact preco nditions '
 'forthepostﬂop solution Inthose prelimina rytests apokermaster the ﬁrst '
 'author played more than  sandwasunab letodefea tthe pseudo optima lstrate '
 'gyIncontrast Pokihadbeen beaten consistently atarate  which ismorethan would '
 'belostbysimply foldin geveryhand Using thesame nobetpreﬂop polic  wasable to '
 'defeat   com pared  forthefullgameincluding preﬂop anddefeated Aada ptiat   '
 'com pared  forthefullgame Allofthepseud ooptim alplayers play substantially '
 'bet terthan anypreviously existing comp uter programs Even  which '
 'isnotdesigne dtoplay thefullgame earns enou ghfrom thepostﬂop betting '
 'roundstooffsettheEV losses from thepreﬂo proundwhere itneverraises good hand '
 'snorfoldsbadones Itissuspiciou  outperform  which inprinciple should '
 'beabetter approximatio nSubseque nt analysis oftheplay  revealed some '
 'programmin g error sandalsosuggested thatthebucketassignmen tsforthe preﬂop '
 'model were ﬂawed This may haveresulted inanin accurate pseudo optima lpreﬂop '
 'strate gyandconseq uent im balances intheprior distrib ution sused asinput '
 'forthepost ﬂop models Weexpect thatthiswill berectiﬁed infuture version  '
 'design willsurpass  in perfo rmance  Testing against human players While '
 'these results areencou raging noneofthenonpseudo optimal compu teropponents '
 'arebetter than intermed iate strength  erTexasHold emTherefo rematches were '
 'cond ucted again sthumanoppo nents More than  tsvolunteer edtoplay against '
 'the pseudo optima lplayer sonourpublicweb applet wwwcs ualberta cagames '
 'poker includin gmanyexpe rienced player safewmasters andoneworld class '
 'player The programs provided some funoppo sition andended up with awinning '
 'record overall The results aresumm aPlayer Hands         Experienced    '
 'Experienced    Experienced    Experienced              Table   matches '
 'Player Hands  thecount                Experienced    Experienced    '
 'Experienced    Experienced                                  Table   matches',
 '                  Table   matches rized inTable    author Exper  isthethird '
 'autho r Inmost cases therelati velyshort length ofthematch leavesahigh '
 'degreeofuncer tainty intheoutco me limit inghowmuch canbesafely conclud '
 'edNevertheless some player sdidappear tohaveadeﬁnite edge while others were '
 'clearly losing Anumbe rofinteresting observ ations were made overthe course '
 'ofthese games Itwasobviousthatmost peop lehada lotofdifﬁculty learning '
 'andadjusting tothecompu tersstyle ofplayInpokerknowing thebasic appro '
 'achoftheoppo nent isessential since itwilldictate howtoproperlyhand le '
 'manysituations thatarise Some playe rswron glyattrib uted intelligence where '
 'nonewaspresent After losing  game match oneexperienced player comm ented the '
 'bothas',
 '         Bets Won Hands Playedthecount  Figure  essofthetheco unt  meﬁgured '
 'outnowindicating thatitsoppo nent modelwas accurate when infactthepseudo '
 'optimal player isoblivious anddoes nomodelin gatall Itwasalso evident that '
 'these progr ams doconside rably better inpracticethan might beexpected '
 'duetotheemo tional frailty oftheir human oppo nents Manyplayer scom mented '
 'thatplaying against thepseud ooptim aloppo nent was anexasperating '
 'experience Thebotroutin elymakesuncon ventio nalplays thatconfu '
 'seandconfound human sInvari ablysome ofthese bizarre plays happ entocoincid '
 'ewith a luckyescape andseveralofthese badbeats inquick succes sion willoften '
 'cause strong emotion alreaction ssometimes referr edtoasgoin gontilt The '
 'levelofplay gener ally goes downsharply inthese circumstan ces This '
 'suggeststhataperfect gametheor eticoptimal poker player could perhap sbeat '
 'eventhebest human sinthelong run because anyEVlostinmom ents ofweakness '
 'would neverberegained Howeverthewinrateforsuch aprogram could stillbequite '
 'small giving itonly aslight advantage Thus itwould beunabletoexertitssuperio '
 'rityconvincing ly overtheshort term such asthefewhund redhand sofone session '
 'oroverthecourse ofaworld champio nship tourn a ment Since eventhebest '
 'humanplayers areknowntohave biases andweakn esses opponent modelin gwill '
 'almost cer tainly benecessary toproduceaprogram thatsurpasses all huma '
 'nplayer s  Testing against aworldclas splayer The elite pokerexpertwasGautam '
 'Raowho isknownas thecou ntorCoun tDracula intheworldofpopularonline  winner '
 'inthehistory oftheoldest onlin egamebyanenorm ousmarginoverall other players '
 'both intotal earning sandindollar perhand rate Hisparticular specialty '
 'isinshorthan dedgames with ﬁveorfewerplayer sHeisrecogn ized asoneofthebest '
 'player sintheworld inthese gamesandisalso exceptional  erHoldem '
 'Likemanytopﬂigh tplaye rshehasa dyna micultraa ggressi vestyle MrRao agreed '
 'toplay anexhibition match  playin gmorethan  hand soverthecourseof '
 'severaldays Thegraph inFigure  ession of thematch Thepseudo optima lplayer '
 'started with some goodfortun e butlostatarateofabout   hands Then there '
 'wasasudde nreversal following aseries offor tuitous outcom esfortheprogram '
 'Althoug hthecou ntis renownforhismental toughness anunco mmon runofbad luck '
 'canbeveryfrustra ting evenforthemost experienced player sMrRaobelie '
 'vesheplayed belowhisbestleveldur ingthatstage which contrib utedtoadram '
 'aticdrop where he   MrRaoresumed play the followingdaybutwasunab '
 'letorecoverthelosses slipping furth  sbafter  sAtthispoint hestoppe d play '
 'anddidacarefu lreassessment Itwasclear thathisnormalstyle formaximizin '
 'gincom e again sttypical human opponents wasnoteffectiveagainst the pseudo '
 'optima lplayer Whereas humanplayers would nor mally succumb toalotofpressur '
 'efrom aggressi vebetting thebotwaswilling tocallallthewaytotheshowdownwith '
 'aslittle asaJack orQueen high card That kind ofplay would befolly against '
 'most opponents butisappropriate again stan extrem elyaggressiveopponent Most '
 'humanplayer sfailto makethenecessary adjustme ntunderthese atypical cond i '
 'tions buttheprogr amhasnosense offear MrRao chang edhisapproach '
 'tobelessaggressivewith immediate  sbincrease over  hand ssome ofwhich '
 'hecredited toagoodrun ofcards MrRao wasable toutilize hisknowledge thatthe '
 'comp uterplayer didnotdoanyopponent modelin gKnowing thisallowsahuman player '
 'tosystematically probeforweak nesses withou tanyfear ofbeing punished '
 'forplayin gina method icalandhighlypredictable mannersince anoblivious oppo '
 'nent does notexploitthose pattern sandbiases Althoug hheenjoyedmuch more '
 'success inthematch from',
 'method icalandhighlypredictable mannersince anoblivious oppo nent does '
 'notexploitthose pattern sandbiases Althoug hheenjoyedmuch more success '
 'inthematch from thatpointforw ardthere were stillsome adv entures such as '
 'thesharp decline  sPokerisagame ofveryhigh varian ceespecially between '
 'twoopponents with sharp styles ascanbeseen bythedramatic swings '
 'overthecourse ofthis match Although  gamesmay seem likealotMrRao s victory '
 'inthismatch wasstillnotstatistically conclu sive Wenowbelie vethat ahuman '
 'pokermaster caneventu allygain asizable advantage overthese pseudo optima '
 'lpro totypes perha  issustainable However itrequir esagood unde rstanding '
 'ofthedesign oftheprogram anditsresulting weakn esses That '
 'knowledgeisdifﬁcultto learn during normal playduetothegood inform ation '
 'hidin g provided byanappro priate mixtur eofplans andtactics This cloud '
 'ofconfu sion isanatur albarrier tooppo nent learning Itwould beevenmore '
 'difﬁcult tolearn against anadapti ve programwith good opponent modelin '
 'gsince anymethod ical testing bythehumanwould beeasily exploited This isin '
 'stark contrast totypical huma nopponents who canoften be accurately mode '
 'ledafter only asmall numb erofhands  andFutureWork The pseudo optimal '
 'players presented inthispaper arethe ﬁrst complete appro ximation sofagameth '
 'eoretic optimal strate gyforafullscale variation ofrealpoker',
 'Severalabstractio ntechniq ueswere exploredresulting in thereasonab '
 'lyaccurate representation ofalargeimperf ect infor mation gametree having '
 'nodes with asmall collection ofmodels ofsize Despite these massi ve reduc '
 'tions andsimpliﬁcation stheresulting progr ams play respectab lyFortheﬁrst '
 'time evercomp uter programs are notcompletely outclassed bystrong human '
 'opposition inthe game  erTexasHoldem Useful abstraction sincluded betting '
 'treereductio nstrun cation ofbetting roundscomb ined with EVleafnodes and '
 'bypa ssing betting rounds  ndmodelancho redat theroot provided apseud ooptim '
 'alstrate gyforthepreﬂo p roundwhich inturnprovided theproperconte xtual '
 'informa tion neededtodetermin econditio nalprobabilities forpost '
 'ﬂopmodelsThemost powerfulabstractions forreducing the problemsize were based '
 'onbucketingamethod forparti tioning allpossible holdings accord ingtostrate '
 'gicsimilarity Althoug hthese metho dsexploittheparticu larstructur eofthe '
 'TexasHoldem gametree theprinciples aregener alenough tobeapplied toawide '
 'variety ofimperf ectinformation do mains Manyreﬁnem ents andimpro vemen '
 'tswill bemade tothe basic techn iques inthecomin gmonth sFurther testing '
 'will also continue since accur ateassessment inahigh varian ce doma '
 'inisalwaysdifﬁcult Thenextstage oftheresearch willbetoapply these tech nique '
 'stoobtain approximation sofNash equilibria for player TexasHoldem This prom '
 'isestobeachalleng ingex tension since multip layer gameshavemanyproperties '
 'that  game Finally havingreasona bleapproximation sofoptimal strate gies '
 'does notlessen theimportan ceofgoodoppo nent mode ling Learnin gagain '
 'stanadapti veadversary ina stochastic gameisachallengin gproblem andthere '
 'will be manyideas toexploreincombin ingthetwodifferentforms ofinformation '
 'That willlikelybethekeydifferen cebetween aprogramthatcancompete with '
 'thebest andaprogram that surpasses allhuman players Quoting thecou nt '
 'Youhave avery strongprogram Once youadd oppo nent modelin '
 'gtoititwillkilleveryon e Acknowledgment s The authors would liketothank '
 'Gautam Rao Sridh ar Mutyala andtheother pokerplaye rsfordonating their valu '
 'able time Wealso wish tothank Daphne KollerMichael Littman Matthe wGinsber '
 'gRich Sutton DavidMcAllester Mason Malmuth andDavidSklansk yfortheir valuab '
 'lein sights inpastdiscussions This research wassuppo rtedinpartbygrants from '
 'theNat ural Sciences andEngin eering Research Council ofCanada NSERC '
 'theAlberta Informatics Circle ofResearch Excel lence iCORE andanIzaak Walton '
 'Killam Memor ialpost gradu atescholar ship References Billings  ADavidson '
 'JSchaef fer andDSzafro nThechalleng eofpokerArtiﬁcial Intelli    DBillings '
 'Theﬁrstinternatio nalrosha mbo programmin gcompetitio n Internatio nal '
 'Computer Games Association Journa    Koller  DKoller andNMegiddoThe comp '
 'lexity oftwoperson zero sum games inextensi ve form Games andEconom    '
 'Koller  andAPfefferRepre sentations andsolution sforgame theoretic problems '
 'Ar tiﬁcial Intellig encepages    Koller  DKollerNMegiddoandBvonSten gel '
 'Fastalgorithm sforﬁndin grandomized strate gies in gametrees STOCpages     '
 'HWKuhnAsimpliﬁed twoper sonpoker Contrib ution stotheTheory ofGames    Nash  '
 'Equilibr iumpointsinnper songames Nationa lAcademy ofScien    Sakagu '
 'chiandSakai  chiand SSakai Solution sofsome threepe rson stud and drawpoker '
 'Mathema ticsJapon icapages    Selby  Optimal heads uppreﬂop poker  edemonco '
 'uksimplex ShiandLittman  JShiand MLittman Abstrac tionmodels forgame theor '
 'eticpokerInCompute rsand',
 'Selby  Optimal heads uppreﬂop poker  edemonco uksimplex ShiandLittman  '
 'JShiand MLittman Abstrac tionmodels forgame theor eticpokerInCompute rsand '
 'Games pages  Spring erVerlag  Sklansk yandMalmuth  DSklansk yand MMal muth '
 'TexasHold emfortheAdvan cedPlayer TwoPlus TwoPublishing   Takusag  KTakusag '
 'awaNash equilibriu mof TexasHold  Under graduate thesis Com puter Science '
 'Stanfor dUniversity vonNeumann andMorgenstern  nand OMorgenstern Theory '
 'ofGames andEcono micBeha v iorPrinceton University Press  ']
151
['The Colle ge of W oos ter Libraries Open W orks Senior I ndependent Study '
 'The ses  The S earch for G TO Determinin g O ptimal Poker Strategy Using '
 'Line ar Programmin g Stuart Youn g The Co llege of W ooster syoun  oosteredu '
 'Follow thi s and a dditional w orks athttpsope nworkswoostereduinde '
 'pendentstudy This Senior I ndependent Study The sis Exemplar is brought to '
 'you b y Open W orks a s ervice of The C ollege of W ooster Libraries It has '
 'be en accepted for inclusion in S enior I ndependent Study The ses by an '
 'author ized admini strator of O pen W orks For mor e infor mation p lease '
 'contact openworksw oosteredu C opyright  S tuart Youn gRecomme nded Citation '
 'Youn g Stuart The S earch for G TO Determinin g Optimal Poker Strategy Using '
 'Linear Programmin g  Senior Independent Study Th esesPaper  httpsope '
 'nworkswoostereduinde  brought to you by CORE View metadata citation and '
 'similar papers at coreacuk provided by The College of Wooster',
 'TheSearch for GTO Determining Optimal Poker Strategy Using Linear '
 'Programming Independent Study Thesis Presented in Partial Fulﬁllment of the '
 'Requirements for the Degree Bachelor of Arts in the Department of '
 'Mathematics and Computer Science at The College of Wooster by Stuart Young '
 'The College of Wooster  Advised by Dr Matthew Moynihan',
 'Abstract This project applies techniques from game theory and linear '
 'programming to ﬁnd the optimal strategies of two variants of poker A set of '
 'optimal poker strategies describe a Nash equilibrium where no player can '
 'improve their outcome by changing their own strategy given the strategies of '
 'their opponents We ﬁrst consider Kuhn Poker as a simple application of our '
 'methodology We then turn our attention to  Draw Poker a modern variant onto '
 'which little previous research is focused However the techniques that we use '
 'are incapable of solving large fullscale variants of poker such as  Draw '
 'Therefore we utilize several abstractions techniques to render a '
 'computationallyfeasible LP that retains the underlying spirit of the game We '
 'use the Gambit software package to build and solve LPs whose solutions are '
 'the optimal strategies for each game iii',
 'Acknowledgements To my advisor Dr Moynihan thank you You have consistently '
 'pushed me to achieve and have remained supportive during di ﬃcult moments '
 'You have furthered my abilities in mathematics critical thinking and writing '
 'these are skills I will always value To my parents Lee Stivers and Peter '
 'Young thank you Beyond just providing me with this education you taught me '
 'why its so important Mom you have inspired my love of scientiﬁc inquiry and '
 'desire for new knowledge Most importantly you are supportive reassuring and '
 'always there for me To my friend and roommate Parker Ohlmann thank you Your '
 'constant support over the last  years has been invaluable as you remind me '
 'to keep all of this in perspective I am inspired every day by your '
 'dedication compassion and kindness in life This project and my time at the '
 'College of Wooster would not have been possible without each of you v',
 'Contents Abstract iii Acknowledgements v  Introduction   Linear '
 'Programming   Basic Theory   Constraints   Solutions   Duality   '
 'Motivation   Theory   Game Theory   Background   Normal Strategic Form   '
 'Equilibrium  vii',
 'viii CONTENTS  Extensive Form   Perfect Information   Imperfect '
 'Information   Nash Equilibrium   Sequence Form   Linear Programming Theory   '
 'Kuhn Poker   Rules   Extensive Form   Normal Form   Strategies   Payo ﬀs   '
 'Player  Optimal Strategy   Player  Optimal Strategy   Sequence Form   '
 'Sequences and Information Sets   Payo ﬀs   Strategy Constraint Matrices and '
 'Realization Plans   Player  Optimal Strategy   Player  Optimal Strategy    '
 'Draw Poker   Rules   Abstractions   Deck Reduction ',
 ' Betting Abstractions   Bucketing   Simulation   Results    Initial '
 'Buckets    Initial Buckets   Conclusion  A Gambit  B Simpliﬁed  Draw LP '
 'Results ',
 'List of Figures  Generalized Twoplayer Strategic Game   Prisoners Dilemma   '
 'Extensive Form Game with Perfect Information   Extensive Form Game with '
 'Imperfect Information and Perfect Recall   Sequence Form Example   Extensive '
 'Form of Kuhn Poker   Player  pure strategies in Kuhn Poker   Player  pure '
 'strategies in Kuhn Poker   Subtree of Kuhn Poker   Payo ﬀfunction example '
 'with  shown in blue   Initial Transition Probabilities to  Buckets   Initial '
 'Transition Probabilities to  Buckets   Final Transition Probabilities from  '
 'Buckets   Final Transition Probabilities from  Buckets  xi',
 'xii LIST OF FIGURES  Part of the Extensive Form of Kuhn Poker in the Gambit '
 'GUI ',
 'List of Tables  Solutions to Player  LP   Player  Optimal Behavioral '
 'Strategy   Hand Rankings with Frequencies in Simpliﬁed  Draw Poker   Initial '
 'Buckets   Final Buckets   Optimal Realization Plan for  Initial Buckets   '
 'Optimal Realization Plan for  Initial Buckets  i',
 'ii LIST OF TABLES',
 'Chapter  Introduction Game theory is a unique ﬁeld of mathematics it '
 'attempts to model the interactions of conﬂict and cooperation between '
 'rational decisionmakers Game theoretic tools are used in a variety of '
 'disciplines including economics political science and philosophy as well as '
 'the study of traditional games While the models retain mathematical rigor '
 'the underlying concepts are rather interdisciplinary Modern game theory '
 'began in  with John von Neumanns proof of the existence of mixed strategy '
 'equilibria in zerosum twoperson games  Another major development was John '
 'Forbes Nash Jrs proof of the existence of his namesake Nash equilibrium in '
 'any noncooperative game Developments in game theory have often followed '
 'historical context most notably World War II  Within the broader ﬁeld of '
 'operations research linear programming is an optimization technique used '
 'speciﬁcally for problems described by linear objective functions and '
 'constraints Various solution algorithms such as the Simplex method o ﬀer '
 'welldeﬁned methods to ﬁnd optimal solutions to ',
 ' CHAPTER  INTRODUCTION broad classes of linear programs Linear programming '
 'methods are frequently used to model business operations and models of '
 'economic competition Developments in linear programming were also motivated '
 'by World War II George Dantzig developed the general theory and Simplex '
 'method in  in response to personnel and equipment planning problems in the '
 'US Air Force  Poker is a fascinating game requiring both psychological and '
 'deductive ability to win In the last ten years understanding of poker '
 'strategy has undergone a radical shift What was once viewed as a simple card '
 'game based mostly on luck is now seen as a highly mathematical deductive '
 'game with complex strategies Many of todays top professional players use '
 'strategies based heavily on game theory and probability if they use a '
 'strategy superior to their opponents they stand to make millions of dollars '
 'Poker strategy interests academic researchers who until recently only made '
 'incremental progress in understanding the optimal strategies of commonly '
 'played variants In  researchers at the University of Alberta announced a '
 'Nash equilibrium solution to Limit Texas HoldEm  In early  researchers at '
 'Carnegie Mellon University developed a Artiﬁcial Intelligence system that '
 'resoundingly defeated a group of professionals at NoLimit Texas HoldEm  '
 'While not quite a Nashoptimal solution it represents a dramatic advance in '
 'the understanding of poker strategy Little formal work has studied games '
 'other than Texas HoldEm',
 'Chapter  Linear Programming The basic purpose of linear programming is to '
 'ﬁnd the optimal solution to a linear function that is limited by a set of '
 'constraints These methods have a wide variety of applications including '
 'economics business and engineering For example a factory might use linear '
 'programming methods to determine a production schedule that satisﬁes product '
 'demand while minimizing total cost Fortunately we can also use them to '
 'determine optimal strategies for games such as poker We present a basic '
 'overview of linear programming theory in this chapter which will be an '
 'important technique in our analysis of poker strategy This section is based '
 'on theory from  which contains much more detail on linear programming and '
 'the Simplex method than we explore here ',
 ' CHAPTER  LINEAR PROGRAMMING  Basic Theory Every linear program LP has a set '
 'of decision variables xjfor  nthat we wish to optimize Decision variables '
 'could represent types of products that a company produces types of raw '
 'materials and production methods to name just a few We wish to maximize or '
 'minimize some linear function of these variables  This fx is called the '
 'objective function of the LP Each cjRis a coe ﬃcient for a particular '
 'decision variable xj These coe ﬃcients can have di ﬀerent interpretations '
 'depending on context for example if fx is a revenue function each cjwould '
 'represent the unit cost of good xj A particular LP can seek to either '
 'maximize or minimize this function a business could want to minimize cost or '
 'maximize proﬁt Fortunately we can easily convert between a minimization LP '
 'and maximization LP by changing the sign minimizing fx is equivalent to '
 'maximizing fx  Constraints This objective function is maximized or minimized '
 'according to a set of constraints which have the general form  b',
 'CHAPTER  LINEAR PROGRAMMING  For example an LP that seeks to maximize proﬁt '
 'could have a constraint speciﬁying the minimum number of each product xjthat '
 'must be produced in order to meet demand We can convert between equality and '
 'inequality constraints as follows If we have an inequality constraint of the '
 'form  we can convert it to an equality constraint by adding a nonnegative '
 'slack variable wsuch that  For a constraint of the form  we can convert it '
 'to an equality constraint by subtracting a nonnegative surplus variable '
 'vsuch that  Finally an equality constraint of the form ',
 ' CHAPTER  LINEAR PROGRAMMING can be converted to inequality form by '
 'replacing it with the two constraints   since a particular xsatisﬁes both '
 'constraints only at equality The ﬁnal components of an LP are the sign '
 'restrictions on each decision variable xj For an LP with a maximization '
 'objective function we use the sign restrictions  for  n For a minimization '
 'LP we also use  for  n These sign restrictions are additional constraints in '
 'the sense that they restrict the allowable values of xj We now deﬁne the '
 'standard form representation of a linear program as Maximize  subject to     '
 'We can also write the standard form with matrix notation Maximize cTx '
 'subject to Axb ',
 'CHAPTER  LINEAR PROGRAMMING  where Ais an mbynmatrix of constraint coe '
 'ﬃcients aijcis a vector of length nof objective function coe ﬃcients and bis '
 'a vector of righthand side coeﬃcients of length m  Solutions We now consider '
 'the solution methods and solution types of LPs Most LPs are much too complex '
 'to solve by hand or by graphical methods Instead we typically use the '
 'Simplex method algorithm Broadly the Simplex method searches the vertices of '
 'the feasible region to ﬁnd the optimal solution The mechanics of the Simplex '
 'method are not a focus of this project and are well documented elsewhere '
 'including in  Using the Simplex method we can ﬁnd several di ﬀerent types of '
 'solutions Anntuple  specifying a value for each decision variable is a '
 'solution it is a feasible solution if it satisﬁes all of the constraints of '
 'the LP and an optimal solution if it corresponds to the actual maximum or '
 'minimum of the LP The optimal solution is also a feasible solution by '
 'deﬁnition Any solution that fails to satisfy one or more constraints is an '
 'infeasible solution The following deﬁnitions further detail types of '
 'solutions Deﬁnition  A constraint axb isactive at a particular solution x if '
 'a xb Deﬁnition  A solution x is a basic feasible solution if it has at least '
 'n linearly independent active constraints Deﬁnition  A solution x is a basic '
 'optimal solution if it has n linearly independent active constraints and f '
 'xis the desired minimum or maximum Linear programs that have no optimal '
 'solution are split into two',
 ' CHAPTER  LINEAR PROGRAMMING categories Some LPs have no feasible solutions '
 'that is the space deﬁned by the constraints is empty For example consider '
 'the LP Maximize  subject to     Note that the second constraint can be '
 'rewritten as  This is contrary to the ﬁrst constraint there is no  that '
 'satisﬁes  and  Thus there are no feasible solutions to this LP We call an LP '
 'that has no feasible solutions infeasible In contrast some LPs are said to '
 'be unbounded An unbounded LP has feasible solutions for arbitrarily large '
 'objective function values For example consider the LP Maximize  subject     '
 'and  any solution of this form satisﬁes both constraints and is feasible As  '
 'so does  Thus fx takes on arbitrarily large values and is unbounded We can '
 'now categorize the solution categories',
 'CHAPTER  LINEAR PROGRAMMING  of all linear programs with the following '
 'theorem Theorem  Fundamental Theorem of Linear Programming For an arbitrary '
 'linear program in standard form the following statements are true  If there '
 'is no optimal solution then the problem is either infeasible or unbounded  '
 'If a feasible solution exists then a basic feasible solution exists  If an '
 'optimal solution exists then a basic optimal solution exists For more detail '
 'and a proof of this theorem see   Duality For many applications of linear '
 'programming it is useful to consider the dual LP associated with a '
 'particular primal LP These structures come in pairs the following section '
 'details their relationship In short every feasible solution for one of the '
 'programs characterizes a bound on the optimal objective function value of '
 'the other In fact both LPs will have the same optimal objective function '
 'value  Motivation Before exploring duality theory in general we o ﬀer a '
 'motivating example Consider the following LP Maximize  subject to   ',
 ' CHAPTER  LINEAR PROGRAMMING Denote the optimal solution to this LP x and '
 'the corresponding optimal objective function value as fx Consider a '
 'particular feasible solution  which has a objective function value of  In e '
 'ﬀect thiszacts as a lower bound for the optimal objective function value z '
 'Since we are attempting to maximize our objective function the optimal '
 'solution must satsify  If we cannot ﬁnd another feasible solution such that '
 'this is true it must be the case that  and  Thus each fx acts as a lower '
 'bound for the optimal fx We can also place upper bounds on fx as follows '
 'Consider the sum of the three constraints     Since each variable is '
 'nonnegative this sum forms an upper bound on the optimal objective function '
 'value that is  Therefore we have   We can ﬁnd other upper bounds by '
 'considering any linear combination of the constraints of the LP in  We have '
 'signiﬁcantly narrowed the range of possible values for fx but we can further '
 'reduce the size of this interval Before we considered a particular linear '
 'combination of the constraint vectors We now consider a',
 'CHAPTER  LINEAR PROGRAMMING  linear combination with variables  and  the '
 'respective constants and ﬁnd these yvalues that give an upper bound of  on '
 'fx We have     Assume that each of the xicoeﬃcients is the same as in the '
 'original objective function That is    Thus    Since fx is bounded above '
 'by   we can minimize this sum in order to ﬁnd the most speciﬁc upper bound '
 'for the original LP This new',
 ' CHAPTER  LINEAR PROGRAMMING objective function is constrained by  and we '
 'naturally have the dual LP Minimize  subject to    This is the dual LP '
 'associated with the given primal LP  Intuitively the dual LP seeks to '
 'minimize maximize the upper lower bound on the primal objective function '
 'respectively  Theory We now present the formal theory of duality emphasizing '
 'the relationship between primaldual LP pairs and their respective solutions '
 'We also consider the relationship between various solution types and the '
 'dual LP Deﬁnition  For a primal LP in the standard form of Maximizen  '
 'subject ton   ',
 'CHAPTER  LINEAR PROGRAMMING  the corresponding dual LP is given by '
 'Minimizem  subject tom    Proposition  The dual of a dual LP is the primal '
 'LP Proof To verify this relationship we must ﬁrst write the dual problem in '
 'standard form Recall that a standard form LP maximizes its objective '
 'function and has constraints The sign restrictions remain the same Since '
 'minimizing a function is equivalent to maximizing its negative we have minm  '
 'm  We can convert the constraints toby multiplying both sides by  Thus the '
 'standard form of the dual LP is given by Maximizem  subject tom   ',
 ' CHAPTER  LINEAR PROGRAMMING The dual of this LP is Minimizen  subject '
 'ton    which is equivalent to the primal LP given by Maximizen  subject '
 'ton    We can also characterize the relationship between the feasible '
 'solutions of the primal and dual LPs Theorem   Weak Duality Theorem If  a '
 'feasible solution for the primal LP and  feasible for the associated dual LP '
 'then jcjxj ibiyi',
 'CHAPTER  LINEAR PROGRAMMING  Proof We have the following series of '
 'inequalities jcjxj j iyiaij xj ijyiaijxj i jaijxj yi  For the ﬁrst '
 'inequality we know that each  by  that cj iyiaijfor each jby  The second '
 'inequality is similar  by  and jaijxjbi by  for each i From the Weak Duality '
 'Theorem we know that all of the primal objective function values for '
 'feasible solutions are less than all of the dual objective function values '
 'For an arbitrary primal feasible solution xfxgy for all dual feasible '
 'solutions y where fand gare the primal and dual objective functions '
 'respectively This provides an upper bound for every primal objective '
 'function value Similarly the objective function value for any primal optimal '
 'solution provides a lower bound for every dual objective function value '
 'Therefore we can characterize the optimal solutions xand yas those for which '
 'fxgy We now have the necessary background to draw a connection between the '
 'optimal solutions of a primaldual LP pair We present the following theorem '
 'without proof as the particular mechanics are outside the scope of this '
 'project',
 ' CHAPTER  LINEAR PROGRAMMING For more detail see  Intuitively this theorem '
 'states that the objective functions for a primaldual pair of LPs is equal '
 'precisely at the optimal solution to each Theorem   Strong Duality Theorem '
 'For an optimal solution xRnto a primal LP there is a dual LP which has an '
 'optimal solution yRnsuch that jcjx j ibiy i',
 'Chapter  Game Theory This chapter presents several concepts in game theory '
 'that are central to this project We focus on the various representations and '
 'types of games as well as the associated Nash equilibria These concepts will '
 'later be used in conjunction with the linear programming theory of the '
 'previous chapter to develop a method of representing and solving two '
 'variants of poker  Background The purpose of game theory is to develop '
 'mathematical models that represent decisionmaking interactions among '
 'individuals We assume that these individuals are both rational in their own '
 'decisions and take into account expectations of how the other decisionmakers '
 'will act  Game theory can be used to model a wide range of situations '
 'including business negotiations political competition and economic models of '
 'oligopolistic competition as well as traditional games such as chess '
 'checkers and poker Game theoretic models are highly abstracted versions of '
 'the actual situation ',
 ' CHAPTER  GAME THEORY Unlike many other ﬁelds of mathematics the study of '
 'game theory attempts to both positively describe how individuals domake '
 'decisions and normatively how they should under the assumption of perfect '
 'rationality The modern ﬁeld of game theory is relatively new and is '
 'generally considered to have begun in the  century with Cournot Bertrand and '
 'Edgeworths respective work on models of oligopoly pricing  These ideas '
 'developed to a more general theory of games in the  century with John von '
 'Neumanns proof of the existence of mixedstrategy equilibria in twoperson '
 'zerosum games He later coauthored the seminal Theory of Games and Economic '
 'Behavior with Oskar Morgenstern  This text considered theoretical results '
 'about cooperative games with several players and o ﬀered a axiomatic '
 'conception of utility theory that allowed mathematicians to formalize '
 'decisionmaking under uncertainty Additionally it introduced the concepts of '
 'the normal or strategic and extensive forms as well as a proof of the '
 'existence of a maximin equilibrium for all twoplayer zerosum games  With '
 'zerosum games fairly well understood attention turned to the more general '
 'case of non zerosum games which are perhaps more common In  John Forbes Nash '
 'Jr proved the existence of an optimal strategy for each player in every '
 'noncooperative game  The Nash equilibrium is a generalization of '
 'Morgensterns maximin theorem for non zerosum games and requires that each '
 'players optimal strategy be a payo ﬀmaximizing response to his correct '
 'expectation of his opponents strategy This guarantee was a signiﬁcant '
 'advance in the ﬁeld and allowed the study of a broader class of games ',
 'CHAPTER  GAME THEORY   Normal Strategic Form One of the most common '
 'representations of a game is the normal form also known as the strategic '
 'form Intuitively it represents a game as a payo ﬀ matrix with each players '
 'pure strategies as particular rows and columns The payo ﬀs to each player '
 'are determined by their respective strategies The normal form is the typical '
 'representation for small  games with simultaneous decision making but can be '
 'extended to larger games and those that initially appear to have '
 'nonsimultaneous decision making The concepts in this section are based '
 'heavily on  We begin with the formal deﬁnition of a normal form game '
 'Deﬁnition  A game in normal strategic form is a tuple NAii with a ﬁnite set '
 'of N players for each player iN the nonempty set of available actions Ai a '
 'set of action proﬁles aajfor jN where each a jcorresponds to a particular '
 'action in A j for each player iN a preference relationion A  jN Any such '
 'game with a ﬁnite set of actions A ifor each player i is considered ﬁnite '
 'Notice that the preferences of each player iare deﬁned over A instead of Ai '
 'that is their preferences are deﬁned over each combination of the other '
 'players outcomes as well as their own This distinguishes a strategic game '
 'from a more general decision problem players are concerned with their',
 ' CHAPTER  GAME THEORY opponents actions and payo ﬀs as well as their own The '
 'normal form model of a game is intentionally abstract allowing it to be '
 'applied to a wide variety of situations The set of players Nmay consist of '
 'individuals animals governments businesses etc Likewise the set of actions '
 'Aimay contain only a few simple actions or complicated sets of contingencies '
 'over many potential outcomes The primary restriction on the elements of Nand '
 'each Ais that each player has a welldeﬁned preference relation over all '
 'outcomes of action proﬁle combinations For example the preference relation '
 'for a business might be a function that maps particular actions to proﬁt '
 'levels This deﬁnition considers a generalized preference relation i '
 'typically and for our purposes we can use a more intuitive payo ﬀfunction ui '
 'In this case we denote a particular game as NAiui This payo ﬀfunction uimaps '
 'a particular combination of action proﬁles to a numerical payo ﬀvalue These '
 'inputs can be represented either as a singular action proﬁle aAor as a tuple '
 'to highlight the actions of individual players For example a particular  '
 'represents the payo ﬀto player  for a particular combination of each players '
 'actions aA This action proﬁle adeﬁnes a particular action ajfor each player '
 'jfrom their action set Aj Alternatively we may wish to highlight particular '
 'action proﬁles from distinct players as separate inputs to ui Players '
 'typically wish to choose a set of actions that maximize this value wish '
 'could represent proﬁt utility etc The utility function describes how a '
 'particular player feels about a particular combination of actions of allof '
 'the players in the game Deﬁnition  For a game with a set of outcomes A  jN '
 'the function u iARis the payoﬀfunction with u iauibwhenever aib for',
 'CHAPTER  GAME THEORY  combinations of actions a bA In a game players make '
 'choices about how they will play Each of these choices is a particular '
 'action take by a player at some point in the game In a game with more than '
 'one such set of action choices players employ a strategy which is an '
 'algorithmic prescription of every action that a player will choose A '
 'particular strategy could be a simple choice between two actions or a '
 'complicated set of prescriptions to choose actions based on various '
 'contingencies of how the other players act These choices may or may not be '
 'identical across iterations of the game motivating the following distinction '
 'Deﬁnition  Apure strategy siis a deterministic prescription of how an '
 'individual will play a game choosing the same action at every iteration A '
 'strategy set Siis the set of all pure strategies available to player i A '
 'mixed strategy σiassigns a probability to each pure strategy The '
 'probabilities assigned to each pure strategy sin a mixed strategy σare '
 'governed by a global probability distribution For example let  represent the '
 'strategy set of player  with pure strategies  and  some strategic game A '
 'particular mixed strategy  represents player  employing each pure strategy '
 'with the respective probabilities A generalized strategic game is presented '
 'in Figure  Player  is the row player with choice of pure strategies   and '
 'player  is the column player with choice of pure strategies   Each player '
 'chooses a strategy simultaneously and each ordered pair represents the '
 'respective realvalued payo ﬀs for the set of chosen strategies For example '
 'if player  chooses  player  chooses  they will receive respective payo   '
 'Formally',
 ' CHAPTER  GAME THEORY        Figure  Generalized Twoplayer Strategic Game '
 'However each player need not always play the same strategy in this game It '
 'may be necessary to vary their play in order to optimize their expected payo '
 'ﬀ This is the motivation behind the concept of a mixed strategy Recall that '
 'a mixed strategy σiis a probability distribution over all of player is pure '
 'strategies The probabilities assigned to each pure strategy determine the '
 'expected payo ﬀof the mixed strategy For example consider a particular mixed '
 'strategy  which player  chooses  probability  and  probability  Player  uses '
 'mixed strategy  where he chooses   with equal probability Then the payo ﬀto '
 'player  is   More generally the payo ﬀfor a mixed strategy proﬁle is a '
 'linear function of the probabilities assigned to each pure strategy  In  the '
 'coe ﬃcient associated with a particular payo ﬀvalue is the product of the '
 'probabilities assigned to the particular pure strategy of each player in '
 'their mixed strategy Player  uses pure strategy  probability   in his mixed '
 'strategy  and player  uses pure strategy  probability   in his mixed '
 'strategy  In this case player  payo  This occurs with probability  ',
 'CHAPTER  GAME THEORY  Therefore the overall expected value to player  for '
 'this  is a weighted sum of the payo ﬀs to each combination of pure '
 'strategies  Equilibrium In any game each player tries to maximize their own '
 'payo ﬀ Payo ﬀs are dependent on the combination of strategies that each '
 'employs Thus the decision of which strategy to employ is critical This '
 'section begins by considering the Nash equilibrium of any normal form game '
 'and then considers the more speciﬁc case of Maximin equilibrium in strictly '
 'competitive games Both refer to a steady state wherein each player correctly '
 'assumes how the others will play and chooses his own strategy rationally in '
 'response Generally a game is said to be in equilibrium if no player can '
 'improve their payo ﬀby unilaterally changing strategy Nash Equilibria The '
 'concept of the Nash equilibrium is well illustrated through the classic '
 'example of the Prisoners Dilemma as shown through a normal form '
 'representation in Figure  This is a standard example in game theory '
 'literature and illustrates several important concepts The rules of the game '
 'are as follows Two individuals are arrested by the police and are suspected '
 'of committing a crime together The police lack su ﬃcient evidence to convict '
 'either on the most serious charge but enough to convict either on a less '
 'serious charge Each individual is o ﬀered a choice betray the other and '
 'testify to the police that the other committed the most serious crime or '
 'stay silent and accept the conviction of the lesser charge If both betray '
 'each other the',
 ' CHAPTER  GAME THEORY penalty is reduced by one year for each The '
 'individuals cannot communicate with each other as they decide whether or not '
 'to betray their coconspirator Unsurprisingly they each want to minimize the '
 'number of years that they spend in prison The potential payo ﬀs in years in '
 'prison respectively are shown in Figure   Betray Silent    Silent   Figure  '
 'Prisoners Dilemma We can determine each players best strategy by considering '
 'the potential payo ﬀs of each of their choices along with the other players '
 'choices Each player chooses if they want to confess If the row player stays '
 'silent he will serve  years in prison if the column player also stays silent '
 'or he will walk free if the column player confesses Conversely if the row '
 'player does confess he will serve  years or  year respectively In either '
 'case the dominant strategy is for the row player to confess since he will '
 'receive less prison time in each contingency of the column players choice We '
 'can repeat this analysis for the column player and ﬁnd that his dominant '
 'strategy is also to confess If both players choose rationally and consider '
 'what the other may do they will both choose to confess This is the Nash '
 'equilibrium of the Prisoners Dilemma With this intuitive understanding we '
 'can now formalize this logic and develop the theory more generally This '
 'section focuses on the Nash equilibrium of the normal form representation '
 'the concept extends naturally',
 'CHAPTER  GAME THEORY  to the extensive form and will be discussed in '
 'section  Deﬁnition  ANash equilibrium of a normal form game NAii is a proﬁle '
 'aA of actions with the property that for every player i N we have a ia iia '
 'iaiaiAiiN For a game with deﬁned utility functions u i this condition is uia '
 'ia iuia ia iaiAiiN In this deﬁnition we denote an optimal action proﬁle for '
 'player iasa i and a nonoptimal action proﬁle ai All players other than iare '
 'denoted byi For a proﬁle ato be a Nash equilibrium it must be the case that '
 'no player ihas an action with an outcome preferable to the corresponding '
 'outcome in the optimal a i given that every other player chooses their '
 'optimal a j Here we consider a utility function with multiple inputs of '
 'action proﬁles each representing one or more players whose union is a member '
 'of A Consider the second case with speciﬁed utility functions Player iuses '
 'his optimal action proﬁle a i as do all other players i The payo ﬀto player '
 'i deﬁned by ui is greater than or equal to his payo ﬀwhen all other players '
 'continue to use their optimal a iand he uses a nonoptimal ai No player has '
 'reason to deviate from their strategy given the strategy of the other '
 'players A similar conception of the Nash equilibrium applies to other game '
 'forms While this extends to nplayer games we are most concerned with the two',
 ' CHAPTER  GAME THEORY player case Here the Nash equilibrium criterion is '
 'given by     and     The payo ﬀto each player is at least as great playing '
 'their optimal action proﬁle a   by playing any nonoptimal  This combination '
 'of action proﬁles a  a  a Nash equilibrium Maximin Equilibrium We now turn '
 'our attention to the speciﬁc case of Nash equilibria for a twoperson zerosum '
 'game This section is heavily derived from  beginning with the following '
 'deﬁnition Deﬁnition  A strategic game  isstrictly competitive orzero sum if '
 'for any a bA we have  if and only if  For utility functions u  and u  this '
 'condition is u  and only if u  Recall that the inputs to each uiare either '
 'elements of A which are tuples of actions proﬁles for multiple players or '
 'elements of Ai which are individual players action proﬁles If player  '
 'preference relation  given by the payo ﬀfunction  then player  payo '
 'ﬀfunction  such that  for any strategies  and  That is a payo ﬀgain for '
 'either player corresponds to an equivalent payo ﬀloss for the other This '
 'structure inﬂuences each players strategy as they have no incentive to '
 'cooperate',
 'CHAPTER  GAME THEORY  In a zerosum game each player uses a maximin strategy '
 'in Nash equilibrium A player imaximinimizes if he chooses a strategy that '
 'maximizes his own payo ﬀ with the assumption that player jwill choose a '
 'strategy attempting to minimize player is payo ﬀ Each players loss is the '
 'others gain therefore they both assume that they will choose strategies that '
 'beneﬁt themselves and hurt the other In a zerosum game a pair of strategies '
 'is a Nash equilibrium of and only if it is a pair of maximinimizing '
 'strategies Further any such Nash equilibria have identical payo ﬀs to each '
 'player We begin with the following deﬁnition followed by several proofs of '
 'the relationship between maximin and Nash equilibrium Deﬁnition  Let  be a '
 'strictly competitive game The action  amaxminimizer for player  if min   An '
 'action  a maxminimizer for player  if min   By playing a maximin strategy '
 'each player is attempting to maximize their minimum payo ﬀagainst all '
 'possible strategies that their opponent could utilize Player  chooses a '
 'strategy by solving max xmin  and player  chooses a strategy by solving max '
 'ymin  Since neither player knows how the other will play they choose their '
 'own strategy to optimize their respective worstcase scenarios This is '
 'precisely how we determined each',
 ' CHAPTER  GAME THEORY players optimal strategy in the Prisoners Dilemma '
 'Figure  Theorem  For any strictly competitive game with Nash equilibria a '
 'pair of action proﬁles is a Nash equilibrium if and only if the action '
 'proﬁle of each player is a maximinimizer In other words we may ﬁnd a Nash '
 'equilibrium in a strictly competitive game by examining the maximin '
 'strategies of each player Lemma  Let G  be a strictly competitive strategic '
 'game Then max     Further  the problem max   and only if it also solves the '
 'problem min   Proof Since Gis a strictly competitive game we have that  for '
 'any pair of strategies xand y For an arbitrary function f min zfzmax zfz and '
 'arg min zfzarg max zfz These arg values are the zvalues for which min zfz '
 'and max zfz attain their equivalent minimum and maximum fz values Let   not '
 'necessarily optimal strategies for players  and  respectively For every  we '
 'have min    Thus max       ',
 'CHAPTER  GAME THEORY  Proposition  Let G  be a strictly competitive game a '
 'If xyis a Nash equilibrium of G then xis a maximin strategy for player  and '
 'yis a maximin strategy for player  b If xyis a Nash equilibrium of G then '
 'max xmin  ymax  and all Nash equilibria of G yield identical payo ﬀs c If '
 'xand yare maximin strategies for players  and  respectively then xy is a '
 'Nash equilibrium of G Proof We ﬁrst prove a and b in conjunction Let xy be a '
 'Nash equilibrium of G Then  for all  Likewise since  for all  Therefore   '
 'xmin  Similarly  for  Therefore   for all  so that  xmin  Therefore  xmin  '
 'and x is a maximin strategy for player  An analogous argument shows that yis '
 'a maximin strategy for player  and that  ymin xxy so that  ymax  For part c '
 'let vmax xmin  ymax  From Lemma  we know that max ymin  Since xis a maximin '
 'strategy for player  we have  all  Likewise since yis a maximin strategy for '
 'player  we have  all  Setting yyand',
 ' CHAPTER  GAME THEORY xx we have  Since  we conclude that xy is a Nash '
 'equilibrium of G A crucial implication of part c is that a Nash equilibrium '
 'can be found by solving the problem max xmin  For a strictly competitive '
 'game the Nashoptimal strategy is precisely the solution to the maximin '
 'problem If max xmin  ymax  we deﬁne this equilibrium payo ﬀto player  as the '
 'value of the game From Proposition  we know that if vis the value of a '
 'strictly competitive game then any equilibrium strategy gives a payo ﬀto '
 'player  of at least vand to player  at least   Extensive Form A second '
 'representation of many games is the extensive form The extensive form '
 'represents a game as a directed graph that maps all possible moves and '
 'outcomes The extensive form best represents sequential games of '
 'nonsimultaneous decisionmaking It is particularly amenable to imperfect '
 'information games such as poker where some information about the game state '
 'is hidden from each player The following section details the theory of the '
 'extensive form including a discussion of the associated Nash equilibrium We '
 'also distinguish between the extensive form games with perfect and imperfect '
 'information This section closely follows   Perfect Information Deﬁnition  '
 'Anextensive form game with perfect information is represented by the tuple '
 'NHPi where',
 'CHAPTER  GAME THEORY  A ﬁnite set N the set of players A set H of sequences '
 'ﬁnite or inﬁnite that satisﬁes the following three properties The empty '
 'sequence is a member of H  where K may be inﬁnite and L K then  If an '
 'inﬁnite sequence   for every positive integer L then  Each member of H is a '
 'history each component of a history is an action taken by a player A '
 'history  is terminal if it is inﬁnite or if there is no  that  The set of '
 'terminal histories is denoted Z A function P that assigns to each '
 'nonterminal history each member of H Z a member of Nc This P is the player '
 'function Phbeing the player who takes an action after the history h If P hc '
 'then chance determines the action taken after the history h For each player '
 'iN a preference relationion Z Lethbe a history of length k the ordered pair '
 'ha is the history of length  consisting of hfollowed by a For any '
 'nonterminal history h the player function Ph chooses an action afrom the set '
 'Aha haH At the beginning of any extensive game this history is empty no '
 'actions have previously occurred For the empty sequence H the player P '
 'chooses a',
 ' CHAPTER  GAME THEORY member of A Each member of A is an action  For each of '
 'these choices the player deﬁned by  chooses a member of the set  For each '
 'possible choice in  denoted  player  chooses a member of the  This process '
 'iterates until the game reaches a terminal history The concepts illustrated '
 'in this deﬁnition are best illustrated through an example shown graphically '
 'in Figure  This game is the tuple NHPi where  Hhas as elements the  '
 'histories ABAEAFBGBHBGCBGDBHCBHD  and  The respective preference relations '
 'deﬁned by  and  In Figure  the node at the top of the graph represents the '
 'history Here player  chooses between actions Aand B which are the members of '
 'A These actions are shown as line segments originating from the initial node '
 'Once the ﬁrst player has chosen either AorB it is player  turn  If player  '
 'chose action B player  chooses between the members of AB which are the '
 'actions Gand H Then player  chooses between actions Cand D The preference '
 'relations  the ordering of each players preference of outcomes they can also '
 'be utility functions   the same ordering',
 'CHAPTER  GAME THEORY          Figure  Extensive Form Game with Perfect '
 'Information Deﬁnition  Astrategy of player iN in an extensive game with '
 'perfect information NHPi is a function that assigns an action in A hto each '
 'nonterminal history h HZ for which P hi Deﬁnition  A particular action in a '
 'strategy s is denoted by as A strategy set denoted S i is the set of a games '
 'legal strategies for player i with s Si The entire strategy proﬁle for a '
 'game with n players is S  Sn A strategy is a contingency plan for every '
 'possible choice of action in a game given each choice that another player '
 'may make In the game described in Figure  player  always chooses an action '
 'at the initial history and makes a later choice between Cand Dif they '
 'previously chose B Thus player   strategies can be described as   The '
 'interpretation of these last four strategies is important as they are',
 ' CHAPTER  GAME THEORY contingent on player  actions For example the strategy '
 'BGCHD represents the following contingency plan after ﬁrst choosing action B '
 'if player  chooses G take action C Otherwise if player  takes action H '
 'player  chooses D Player  strategies are simpler and can be described as   '
 'The strategy AEBG is interpreted as follows if player  chooses A choose E '
 'Otherwise if player  chooses B choose G It is important to note that a '
 'particular strategy deﬁnes the action to be chosen for each history even if '
 'that history is never reached when the strategy is employed For example '
 'consider the strategy AGCHC for player  If he chooses action A the later '
 'choice between Cand Dcannot happen Despite this we still specify what '
 'player  would do in that scenario In this way a formal strategy in an '
 'extensive game di ﬀers from an intuitive plan of action Deﬁnition  Apure '
 'strategy siof player iN in an extensive game NHPi is a deterministic '
 'prescription of how to play a game A mixed strategy σiis a probability '
 'distribution over all pure strategies This concepts of pure and mixed '
 'strategies is similar to that in the normal form representation For the game '
 'in Figure   and  are the pure strategies We use the following notation to '
 'distinguish between the pure and mixed strategies of the various players in '
 'any game We often consider the strategy of a particular player i while '
 'holding the strategies of his opponents ﬁxed Let siSidenote the strategy '
 'selection for all other players than i and',
 'CHAPTER  GAME THEORY  write s isi for the proﬁle   For mixed strategies we '
 'let σ   How do players choose which strategy to use In some games certain '
 'strategies will be clearly superior to others based on a comparison of the '
 'payo ﬀs For example consider player  choice between moves Eand Fin Figure  '
 'Since player  payo ﬀtoEis strictly greater than his payo ﬀtoF he should use '
 'an overall strategy that chooses the former Any pure strategy that '
 'prescribes choosing Fis inferior to one that prescribes choosing E This is '
 'an example of a strictly dominated strategy deﬁned below This game has no '
 'weakly dominated strategies Deﬁnition  A pure strategy s iisstrictly '
 'dominated for player i if there exists a mixed strategy σ isuch that uiσ '
 'isiuisisisiSi The strategy s iisweakly dominated if there exists a σ isuch '
 'that this holds with weak inequality and the inequality is strict for at '
 'least one s i',
 ' CHAPTER  GAME THEORY  Imperfect Information Thus far we have described an '
 'extensive form game with perfect information where each player is perfectly '
 'knowledgeable about their opponents actions and the state of the game A '
 'generalization of this is games with imperfect information where players are '
 'not aware of all relevant information about the game Poker is an example of '
 'this type of game during a hand neither player knows which cards the other '
 'is holding Deﬁnition  Anextensive game with imperfect information is deﬁned '
 'as a tuple NHPifcIiiN with analogous structures as Deﬁnition  with the '
 'addition of the following A function f cthat associates with every history h '
 'for which P hc a probability measure f chon A h where each such probability '
 'measure is independent of every other such measure A particular f cahis the '
 'probability that a occurs after the history h For each player iN a partition '
 'IiofhHPhiwith the property that AhAhwhenever h and hare in the same member '
 'of the partition For IiIiwe denote by A Iithe player P hfor any hIi The '
 'partition Iiis the information partition of player i a set I iIiis an '
 'information set of player i In a imperfect information game players are '
 'often uncertain of the exact game state given that their opponents have '
 'hidden information and vice versa While the player does not know the '
 'particular game state they are aware of its composition rules and number of '
 'its possible states Chance',
 'CHAPTER  GAME THEORY  determines the particular game state The Chance player '
 'cis represented by fc which deﬁnes a probability measure for each history '
 'hsuch that Phc For example consider a card game in which two players hold '
 'one of three cards with none repeated Since there are  possible combinations '
 'of cards   the relevant history h This probability is uniform across each '
 'deal deﬁning a complete probability distribution The ﬁnal key structures in '
 'an imperfect information game are the information partitions Iiand '
 'information sets Ii Each player ihas a singular Iithat partitions the set of '
 'histories Hinto information sets Ii An information set describes all of the '
 'histories that are identical from the point of view of a particular player '
 'Of course these histories are not actually identical they diﬀer only in the '
 'hidden information Two histories hand hare in the same information set only '
 'if AhAh That is the set of actions available for the two histories is '
 'identical Notice that this implies the known information is identical for '
 'all elements of an information set the player cannot distinguish between '
 'them Deﬁnition  An extensive form game has perfect recall if for each player '
 'i we have XihXihwherever the histories h and hare in the same information '
 'set of player i In a game with perfect recall no player forgets information '
 'that they knew at a previous state This information includes previous '
 'actions and any hidden information known only to that player as well as '
 'previous information sets Later information sets must reﬁne previous '
 'information sets from earlier histories If this is not the case then the '
 'game has imperfect recall It is not',
 ' CHAPTER  GAME THEORY necessary that an extensive form game with imperfect '
 'information have perfect recall some have imperfect recall However the '
 'variants of poker examined in later sections are both games of perfect '
 'recall                Figure  Extensive Form Game with Imperfect Information '
 'and Perfect Recall Figure  shows an extensive form game with imperfect '
 'information and perfect recall In this example neither player knows which '
 'action that the other takes For example when player  is deciding between '
 'actions Oand P he does not know if player  has previously chosen MorN '
 'Player  has a single information set comprising both of his decision nodes '
 'and all four associated actions This information set is represented by the '
 'ﬁrst dashed line at these nodes he does not know if player  just took action '
 'MorN Player  has two information sets each with two nodes and four '
 'associated actions His ﬁrst information set represents the two possible '
 'moves by player  Oand P after he chose action Mat the beginning of the game '
 'His second',
 'CHAPTER  GAME THEORY  information set contains the two game states possible '
 'after he chose action N originally Notice that these player  information '
 'sets reﬁne previous distinctions there is one set where he previously took '
 'action M and another where he took action N Further notice that player  '
 'possible actions are identical across all nodes in an information set but '
 'are also unique to that information set He faces the choice between land '
 'ronly when he previously chose M and between Land Ronly when he previously '
 'chose N Deﬁnition  Apure strategy of player iN in an extensive game with '
 'imperfect information NHPifcIiiN is a function that assigns an action in A '
 'Iito each information set I iIi Deﬁnition  Amixed strategy of player i in an '
 'extensive game with imperfect information NHPifcIiiN is a probability '
 'measure over the set of player is pure strategies A behavioral strategy of '
 'player i is a collection βiIiIiIiof independent probability measures where '
 'βiIiis a probability measure over A Ii For any history hIiIiand action aAh '
 'we denote by βiha the probabilityβiIia assigned by βiIi to the action a That '
 'isβiIia is the probability that player iwill choose action ainformation set '
 'Ii The collection of these probabilities for each possible action within '
 'each information set deﬁnes a behavioral strategy This distinction between a '
 'mixed strategy and a behavioral strategy illustrates two ways in which a '
 'player may choose to randomize their behavior A mixed strategy uses a '
 'probability distribution over all possible pure strategies whereas a '
 'behavioral strategy uses separate probability distribution for each '
 'information set The resulting randomized strategy appears identical to an '
 'observer of the game and may be outcome',
 ' CHAPTER  GAME THEORY equivalent Deﬁnition  LetσσiiNbe a proﬁle of mixed or '
 'behavioral strategies for an extensive game with imperfect information The '
 'outcome Oσofσis the probability distribution over the terminal histories '
 'that results when each player i follows the strategy speciﬁcation of σi '
 'Deﬁnition  Two strategies either mixed or behavioral are outcome equivalent '
 'if for every collection of pure strategies of the other players the two '
 'strategies induce the same outcome Proposition  For any mixed strategy of a '
 'player in a ﬁnite extensive game with perfect recall there is an '
 'outcomeequivalent behavioral strategy  Nash Equilibrium We now present a '
 'brief theory of the Nash equilibrium for extensive form games with imperfect '
 'information Deﬁnition  ANash equilibrium in mixed strategies of an extensive '
 'game is a proﬁleσof mixed strategies with the property that for every player '
 'i N we have Oσ iσ iiOσ iσi for every mixed strategy σiof player i A Nash '
 'equilibrium in behavioral strategies is deﬁned analogously This version of '
 'the Nash equilibrium is very similar to that of the normal form and the '
 'extensive form perfect information case The optimal mixed strategy',
 'CHAPTER  GAME THEORY  σ ihas a more preferable outcome Othan any nonoptimal '
 'strategy σi No player can beneﬁt by unilaterally changing his strategy In a '
 'mixed strategy Nash equilibrium we have a probability distribution over each '
 'possible pure strategy In a behavioral strategy Nash equilibrium we have a '
 'probability distribution over the actions in each information set The '
 'following lemma is implied by Proposition  Lemma  For an extensive game with '
 'perfect recall the Nash equilibria in mixed and behavioral strategies are '
 'equivalent  Sequence Form The ﬁnal game representation that we consider is '
 'the sequence form which is related to the extensive form The extensive form '
 'describes a imperfect information game specifying its information sets '
 'actions payo ﬀs etc While the graphical representation allows the reader to '
 'quickly understand the mechanics of the game well it does not allow for e '
 'ﬃcient computation of an optimal strategy Typically an extensive form game '
 'must be converted to normal form and a maximin LP algorithm considers all '
 'possible pure strategies of the game For an example of this process see '
 'Section  The number of pure strategies is exponential in the size of the '
 'game tree this often makes e ﬃcient computation of an optimal strategy '
 'infeasible  The purpose of the sequence form is to overcome this '
 'disadvantage and allow the e ﬃcient computation of an optimal strategy It is '
 'represented as a matrix scheme similar to the normal form However the pure '
 'strategies from the normal form are replaced with sequences of consecutive '
 'moves Instead of',
 ' CHAPTER  GAME THEORY computing the probabilities assigned to each pure '
 'strategy we consider the realization probabilities of these sequences '
 'actually being played These realization probabilities can be used to '
 'construct a behavior strategy which describes the probability distribution '
 'over each information set These optimal behavior strategies can be found '
 'using an LP algorithm each players optimal behavior strategy is an optimal '
 'solution to the primal and dual LPs respectively This section develops the '
 'theory of the sequence form based on the original development in  Many of '
 'the structures of the sequence form are similar to those in the extensive '
 'form Recall that an extensive form game has a chance player and N personal '
 'players The chance player governs the chance nodes by one or more '
 'probability distributions and the personal players govern the decision nodes '
 'by their prescribed strategy The sequence form deﬁnes a strategy diﬀerently '
 'instead of deﬁning a probability distribution over all pure strategies or '
 'over each information set the player considers each payo ﬀnode of the game '
 'tree and the sequence of actions necessary to get there These sequences are '
 'the basic unit of analysis in this form Deﬁnition  Asequence s of choices of '
 'player i deﬁned by a node a of the game tree is the set of actions in H on '
 'the path from the root node to a The set of sequences of player i is denoted '
 'Si We now denote sas a sequence instead of a strategy as in previous '
 'sections It is clear from context which is being used A sequence is deﬁned '
 'by the particular set of action labels that a player takes on his path to '
 'some node a In a game with perfect recall members of a particular '
 'information set must',
 'CHAPTER  GAME THEORY  have identical histories thus a sequence can be deﬁned '
 'completely in terms of the actions made to arrive at the given node The set '
 'of all sequences Si replaces the set of pure strategies Siin the normal form '
 'We also consider the sequences of the chance player  where each chance node '
 'has an associated probability distribution Payo ﬀs are deﬁned by '
 'combinations of sequences including those of the chance player and all '
 'personal players Deﬁnition  Let h abe a function that maps each terminal '
 'node a to a payo ﬀ vector in Rn The payoﬀfunction   nRNis deﬁned by gshaif s '
 'is the   sequences deﬁned by a leaf a of the game tree and by g  Note that '
 'the chance player sequence soccurs with probability  and will always be the '
 'ﬁrst input in g The tuple  sN is unique for a particular node ain the game '
 'tree therefore the payo ﬀfunction gis well deﬁned The number of sequences is '
 'at most the number of nodes which grows linearly with the size of the game '
 'tree In contrast the number of pure strategies in the normal form grows '
 'exponentially since each pure strategy must consider each combination of '
 'actions at all possible information sets For a twoplayer game with a known '
 'chance player the matrix Pis the payo ﬀmatrix with each of player  and  '
 'sequences as the rows and columns respectively A particular entry Pijis the '
 'payo ﬀof sequences siand sjbeing played by the two respective personal '
 'players that is Pijgssisj Many combinations of sequences between the two '
 'players are impossible they deﬁne combinations of actions that cannot occur '
 'in conjunction with each other Thus the number of nonzero entries in Ais at '
 'most the number of leaves in the game tree All other entries are  since',
 ' CHAPTER  GAME THEORY they have no deﬁned payo ﬀ We must also consider how '
 'particular sequences are chosen by a player For a normal form game players '
 'can use either a pure or mixed strategy both deﬁne a choice of action in '
 'every possible contingency of the game In the sequence form the player must '
 'deﬁne a probability distribution for each information set This distribution '
 'determines the frequency of choosing each action with its associated '
 'sequence For example consider Figure  this game is identical to Figure  but '
 'with player  initial action known to player  Note that player  can now '
 'distinguish between his two decision nodes and that the actions stemming '
 'from each are now unique Player  must choose between sequences oand pif '
 'player  chooses M as well as Oand Pif player  chooses N For example he may '
 'always choose owhen player  choose M and always Pwhen player  chooses N This '
 'is the pure strategy oP In terms of sequences this corresponds to assigning '
 'probabilities  to his sequences ssospsOsP Instead of mixed strategy '
 'probabilities the sequence form uses the realization probabilities of '
 'sequences when the player uses a behavior strategy Intuitively the '
 'realization plan for a particular sequence is a product of individual '
 'decision probabilities of the actions cnecessary to reach that sequence '
 'Deﬁnition  Therealization plan ofβiis a function r iSiRdeﬁned as risi csiβic '
 'where c is an action in a sequence s i This r ifollows   and ',
 'CHAPTER  GAME THEORY                 Figure  Sequence Form Example Each risi '
 'is a real value that represents the product of the individual decision '
 'probabilities of the actions leading to si We now explore the particular '
 'properties of this ri based on  In a game with perfect recall every member '
 'of an information set uIiof player ihas an identical history LetCube the set '
 'of actions possible at u Consider a particular sequence su which we call the '
 'sequence leading to u An action cchosen at this information set extends u '
 'This extended sequence is given by sucsuc cCu Since the choices made by the '
 'player up until that information set are the same any nonempty sequence is '
 'uniquely speciﬁed by its last action c We can now formally deﬁne the set of '
 'sequences Si which has  uIiCuelements',
 ' CHAPTER  GAME THEORY one for each action in each information set and one '
 'for the empty sequence s Each elemenet in Siis a particular sequence s '
 'Notice that the number of sequences in a game is at most the number of '
 'terminal payo ﬀ nodes an LP that considers individual sequences will '
 'typically have fewer variables than an LP that considers all possible pure '
 'strategies Deﬁnition  Theset of sequencesSiis deﬁned asSi sucuIicCu In order '
 'to account for the nonterminal decision nodes the realization plan rihas the '
 'following constraints The initialization of the game represented by the '
 'empty sequence s has probability  Every game has exactly one of these '
 'sequences That is   Since each behavior strategy is a probability '
 'distribution over an information set we know that  Therefore the realization '
 'probability of a sequence must equal the sum of the realization '
 'probabilities for that sequence extended over all of its possible extending '
 'actions c We can think of the probability of reaching a particular sequence '
 'as being distributed over all of these extending actions Formally risu  i  '
 'Finally realization probabilities are nonnegative  i ',
 'CHAPTER  GAME THEORY  The following proposition links a realization plan '
 'with a behavior strategy Recall that a behavior strategy as opposed to a '
 'mixed strategy deﬁnes a probability distribution over all of the actions in '
 'each information set Proposition  Any realization plan arises from a '
 'suitable behavior strategy Proof Consider a realization plan riwith '
 'associated behavior strategy βi and an arbitrary information set uIi Deﬁne '
 'the behavior at uby βicrisuc risucCu  and arbitrarily such that   By '
 'induction on the length of a sequence we have Deﬁnition  by deﬁnition Thus '
 'any realization plan arises from a suitable behavior strategy Deﬁnition  Any '
 'information set u for which r  behavior strategy βiis called irrelevant A '
 'behavior strategy does not prescribe any action over an irrelevant '
 'information set because it will never be reached given earlier prescriptions '
 'of the behavior strategy This will be an important point in Chapters  and  '
 'the sequence form linear programming algorithms output initially surprising '
 'results for some information sets These particular values will be irrelevant '
 'as those information sets cannot be realized under the optimal behavioral',
 ' CHAPTER  GAME THEORY strategy Mixed strategies can also be represented by a '
 'realization plan Recall that a mixed strategy is a combination of pure '
 'strategies with probabilities assigned to each This mixed strategy has a '
 'corresponding set of realization plans that follow Deﬁnition  However '
 'information is lost in converting a mixed strategy to a realization plan '
 'since the later does not need to cover every possible contingency of the '
 'game It only must cover the sequences and information sets that the player '
 'will actually need to choose from with their behavior strategy Fortunately '
 'the realization plan does retain the strategically relevant aspects '
 'Deﬁnition  A set of mixed strategies are realization equivalent if for any '
 'ﬁxed strategies pure or mixed of the other players all of the mixed '
 'strategies deﬁne the same probabilities for reaching the nodes of the game '
 'tree Proposition  Mixed strategies are realization equivalent if and only if '
 'they have the same realization plan Corollary  For a player with perfect '
 'recall any mixed strategy is realization equivalent to a behavior strategy '
 'Thus a realization plan corresponds to a behavior strategy which in turn '
 'corresponds to a mixed strategy By deﬁning a realization plan for each '
 'player we are essentially describing a mixed strategy  Linear Programming '
 'Theory We now deﬁne the necessary linear programming theory to ﬁnd the '
 'optimal strategy for a twoplayer zerosum extensive game with perfect recall',
 'CHAPTER  GAME THEORY  based on  This game is ﬁrst converted to sequence form '
 'using the theory of the previous section The sequence form structures are '
 'used to build a primaldual pair of LPs We want to ﬁnd a pair of realization '
 'plans which can be converted into behavior strategies The components of an '
 'optimal realization plan are probability distributions over each information '
 'set The sequence form translates to a primaldual pair of LPs whose solutions '
 'are the optimal realization plans for each player This section uses the '
 'following notation The realization plans   denoted as column vectors xand '
 'ywhich  respectively The constraint matrices Eand Fshow that xand yare valid '
 'realization plans in accordance with Deﬁnition  with Exeand Fyf Here Eand  '
 'respectively They have    respectively Both eand fare unit vectors of the '
 'appropriate dimension The payo ﬀmatrix   and individual payo ﬀentries are '
 'calculated according to Deﬁnition  The payo ﬀs are with respect to player  '
 'in this zerosum game player  expected payo ﬀs are given byP The expected '
 'payo ﬀto realization plans xand yarexTPyand xTPyfor the respective players '
 'We ﬁrst consider an LP to ﬁnd the best response yof player  to a ﬁxed '
 'realization plan xof player  If player  plays according to x then player  '
 'best response is the optimal solution to the LP Maximize fyxTPy subject to '
 'Fyy ',
 ' CHAPTER  GAME THEORY In this LP player  wants to utilize a realization plan '
 'ythat maximizes his payo ﬀgiven byxTPy This realization plan must correspond '
 'to a legal set of moves giving the constraint Fyy Finally since each element '
 'of yis a probability we have  We also have the dual of this LP given by '
 'Minimize fqqTf subject to  The dual variables are given by the vector q '
 'which has   We have an analogous pair of LPs for the best response xof '
 'player  given realization plan yfor player  This ﬁnds a realization plan '
 'xthat maximizes player  payo ﬀxTPy This xmust satisfy the constraints '
 'xTETeTand  that deﬁne a valid realization plan The primal is Maximize fxxTPy '
 'subject to xTETeT  The dual problem uses the unconstrained vector p which '
 'has   elements It is given by Minimize fpeTp subject to  These LPs describe '
 'algorithms for ﬁnding the optimal realization plans of one player given a '
 'particular realization plan of the other We require an LP',
 'CHAPTER  GAME THEORY  that generates the Nash equilibrium strategies in '
 'which each player actively considers the others strategy Consider that  and  '
 'have the same optimal objective function value that is xTAyeTp This is the '
 'payo ﬀto player  given that player  uses realization plan y Ifyis not ﬁxed '
 'and can be varied by player  he will try to minimize this payo ﬀ Since this '
 'is a zerosum game player  wants to minimize any payo ﬀhe gives to player  as '
 'this will maximize his own payo ﬀ If we consider that ycan vary it must be '
 'subject to the same constraints as  Thus player  optimal strategy is the '
 'solution to the following LP Minimize fypeTp subject  Fyf  Player  optimal '
 'strategy is the solution to the dual LP given by Maximize fxqqTf subject to  '
 'xTETeT  Theorem  The equilibria of a zero sum game with perfect recall are '
 'the optimal primal and dual solutions of this sequence form linear program '
 'whose size in sparse representation is linear in the size of the game tree',
 ' CHAPTER  GAME THEORY Proof Consider the primal LP in  with optimal solution '
 'ypand the dual LP in  with optimal solution xq Based on previous discussion '
 'the number of nonzero entries of the payo ﬀmatrix Pand of the constraint '
 'matrices Eand Fgrows linearly with the game tree By deﬁnition yand pare '
 'feasible solutions to  and  respectively Likewise xand qare feasible '
 'solutions to  and  Multiplying the Fyfconstraint in  by qT and the '
 'constraint in  gives qTfqTFyxTPy  For player  the same process yields '
 'eTpxETpxTPy  We can combine these expressions as eTpxTPyqTf  The inequality '
 'in  is the Weak Duality Theorem  The value of the objective function '
 'xTPyfrom  is bounded from above by its dual objective function value '
 'qTffrom  Analogously  shows this bound for the primaldual pair of  and  and  '
 'for  and  Recall the Strong Duality Theorem  which states that a pair of '
 'primal dual solutions are optimal only if the associated objective functions '
 'are equal Applying this to  and  we have that eTpqTf This implies that '
 'equality holds in   and  Thus xis an optimal solution to  and a best',
 'CHAPTER  GAME THEORY  response to y and vice versa Therefore xand yrepresent '
 'an equilibrium For the dual LP any equilibrium xand yare solutions to  and  '
 'Then equality analogously holds in   and  implying that  and  are solved '
 'optimally ',
 ' CHAPTER  GAME THEORY',
 'Chapter  Kuhn Poker In this chapter we consider the simple game of Kuhn '
 'Poker  Developed in  by Harold W Kuhn as an example of a twoperson zerosum '
 'imperfect information game it is an appropriate starting point in our study '
 'of general Nashoptimal poker strategy We present a graphic version of the '
 'extensive form as well solutions using linear programming methods for both '
 'the normal and sequence forms  Rules In Kuhn Poker there are two players and '
 'a deck containing the cards Jack Queen and King No card is repeated First '
 'each player antes one unit Each player is then dealt one card and the player '
 'with the highest card wins the pot at showdown provided neither player has '
 'folded After the random deal the subsequent betting structure of Kuhn poker '
 'is as follows Player  can choose to either bet one unit or check If player  '
 'bets player  has the option of calling the bet or folding If player  checks '
 'player  can either bet one unit or ',
 ' CHAPTER  KUHN POKER check If player  bets player  can either call or fold '
 'At this point if neither has folded the hand goes to showdown and the player '
 'with the highest card wins the total pot   Extensive Form Figure  shows the '
 'complete extensive form for Kuhn poker For more information on the extensive '
 'form generally see Section  Each node represents a history and each edge is '
 'an available action that progresses the game to a new history The leaves at '
 'the bottom of the tree specify the payo ﬀ to player  of that particular set '
 'of actions and dealt cards Since this is a zerosum game the payo ﬀto player  '
 'is simply the negative of player  payo ﬀ For each edge lower than the '
 'results of the deal a move to the left represents a check or fold and a move '
 'to the right represents a bet or call depending on the situation Each letter '
 'adjacent to an edge labels a sequence and each pair of node colors describes '
 'a sample information set both described in Section  In contrast to the '
 'normal and sequence forms in the following sections the extensive form '
 'depiction does not directly translate to a linear program This background on '
 'the extensive form was found in   Normal Form In addition to the extensive '
 'form representation of Kuhn poker we can also describe its normal form '
 'representation The theory of the normal form and the associated linear '
 'program in this section are modeled on  The normal form shows the payo ﬀs of '
 'particular combinations of each players strategy as an entry of a matrix We '
 'ﬁrst consider all possible strategy',
 'CHAPTER  KUHN POKER  JQ                         mn g hb o pa qr g hb s tc uv '
 'i jd w xc qr i jd s te uv k lf w xe mn k lf o p Figure  Extensive Form of '
 'Kuhn Poker',
 ' CHAPTER  KUHN POKER combinations for each player and particular dealing of '
 'the three cards  Strategies Recall that a pure strategy sin a normal form '
 'game is a deterministic prescription of the strategy set used by a player in '
 'a game A mixed strategy σ is a strategy that assigns a probability to each '
 'pure strategy A pure strategy as a special case of mixed strategy with all '
 'but one strategy having probability zero A player using a pure strategy '
 'would play a game the same way every time while a player using a mixed '
 'strategy would vary their strategy randomly with known distribution For '
 'example in Kuhn Poker a poor pure strategy would be to always bet as player  '
 'A mixed strategy would be to always bet while holding a Jack or King while '
 'betting with a Queen half of the time Each entry in Figure  represents a '
 'complete pure strategy that player  could choose covering all deals and both '
 'betting rounds The prescribed pure strategy for each held card J Q K is read '
 'from the left and the comma delineates player  ﬁrst round betting strategy '
 'from his second round betting strategy A Prepresents a check or fold '
 'Brepresents a bet or call and O represents a nonexistent move option in '
 'player  second betting round Player  will use the pass Pto fold if player  '
 'has just bet and to check if player  has not just bet For example PPB PPO '
 'represents player  betting only while holding a King in the ﬁrst round and '
 'folding all hands if player  bets If player  chooses not to bet after we '
 'check the hand goes to showdown in this case the second half of the strategy '
 'above is irrelevant Note that there is no prescribed strategy O for having a '
 'King in the second round after',
 'CHAPTER  KUHN POKER  player  has bet since this sequence of actions is '
 'impossible if player  always bets while holding a King in the ﬁrst round '
 'Player  can only call or fold player  would never face a bet from player  '
 'PPP PPB PPP PBB BPP OBB BPP OPB BPB OPO BPB OBO PPB PPO PPB PBO PBB POO PPP '
 'PPP BPP OPP BPP OBP BBP OOP PBP POP PBP BOP PPP BBP PPP BPP PPP PBP PPP BBB '
 'PBB BOO PBP BOB PPB BBO PPB BPO PPP BPB BBP OOB PBB POO PBP POB Figure  '
 'Player  pure strategies in Kuhn Poker These pure strategies are found by '
 'manually generating every possible legal combination of actions for player  '
 'including all possible cards held and betting opportunities Player  can hold '
 'any of three potential cards and will encounter up to two rounds of betting '
 'for each Thus each pure strategy must deﬁne what he will do with each card '
 'in each betting opportunity A unique feature to player  pure strategies in '
 'Kuhn Poker is that he will not always have a second opportunity to bet this '
 'only occurs when he checks and player  bets Thus any pure strategy that bets '
 'with a particular card ﬁrst need not prescribe an action for this '
 'nonexistent second round This is a feature unique to pure strategies in the '
 'normal form of a game in the extensive form pure strategies must specify an '
 'action for every possible contingency The pure strategies show in Figures  '
 'and  represent all possible combinations of betting actions for each player '
 'Player  has  pure strategies and player  has  pure strategies Each B',
 ' CHAPTER  KUHN POKER PPBPPB BPBPPB PPBPBB BPBPBB PPP PPP BBP BPP PPP PPB PPP '
 'BPB PPBBBB BPP PPP BPBBPP BPP PPB BPP BPB PBBPPB PBP PPP PBBBPP PBP PPB PBP '
 'BPB BBP PBB PPBPPP BBBBPP BBP PPB BBP BPB PBBPBB BBP PPP PPP PBP PPP BBP PPP '
 'PBB BBBPBB BPBPPP BPP PBP BPP BBP BPP PBB BBBPPB PBBPPP PBP PBP PBP BBP PBP '
 'PBB BPBBPB BBBPPP PPBPBP PPBBBP PPP BBB BPBBBB PPP BPP BBP PBP BBP BBP BPP '
 'BBB PBBBPB BPP BPP BPBPBP BPBBBP PBP BBB PBBBBB PBP BPP PBBPBP PBBBBP BBP '
 'BBB BBBBPB PPBBPP BBBPBP BBBBBP PPBBPB BBBBBB Figure  Player  pure '
 'strategies in Kuhn Poker and Pentry has the same meaning and the comma '
 'separates the actions that player  will take after player  checks from when '
 'player  bets The letters to the left of the comma prescribe strategy for '
 'when player  has just checked and to the right for when he has just bet Note '
 'that since none of player  betting actions are dependent on his own previous '
 'actions all combinations of bets are deﬁned for each round For example PPB '
 'PPB represents player  always calling or betting while holding a King and '
 'checking or folding otherwise The strategy sets   as elements each of the '
 'strategies shown in Figures  and  A particular strategy  an element in the '
 'set for example PPP PPB An action within a strategy asis a particular '
 'prescription for a players action when faced with a particular situation For '
 'example many strategies prescribe that player  bet while holding a King in '
 'the ﬁrst round of betting Note that many actions are common to multiple '
 'strategies such as this example',
 'CHAPTER  KUHN POKER  Each player in Kuhn Poker has many weakly dominated '
 'strategies which typically stem from a particular action athat is never '
 'advantageous to do Since the purpose of our analysis is to determine the '
 'optimal strategy for each player we can ignore these weakly dominated '
 'strategies These can be identiﬁed intuitively For example we can eliminate '
 'all of player  strategies involving folding a King after player  has bet '
 'Player  will always win at showdown with that hand and gives up their ante '
 'by folding Thus those strategies are weakly dominated by all others We also '
 'eliminate any player  strategy that calls a bet with a Jack bets in the ﬁrst '
 'round with a Queen as well as any player  strategy that prescribes a bet '
 'with a Queen after player  has passed In these last two cases the player has '
 'nothing to gain by betting with a Queen the opposing player will always pass '
 'with a worse hand a Jack and bet with a better hand a King In each case the '
 'payo ﬀexpectation is at least as great if the player passes while holding a '
 'Queen The bolded strategies in Figures  and  represent the nonweakly '
 'dominated strategies  Payo ﬀs In order to ﬁnd the Nash equilibria of Kuhn '
 'poker we must ﬁrst calculate the payo ﬀs for the entire strategy set This '
 'corresponds to the normal form representation shown in  This matrix '
 'represents the payo ﬀs to player  for each pair of pure strategies employed '
 'with player  as the row player and player  as the column player The value in '
 'each matrix entry is the overall payo ﬀof the game to player  since this is '
 'a zerosum game the payo ﬀs to player  are simply the corresponding negatives '
 'Each matrix entry is the sum',
 ' CHAPTER  KUHN POKER of all payo ﬀvalues over the  potential deals '
 'JQJKQJQKKJKQ PPBPPB BPBPPB PPBPBB BPBPBB PPP PPB    PPP     BPP OBB    BPP '
 'OPB    BPBOPO  BPBOBO    PPBPPO        P   Player  Optimal Strategy Using '
 'the normal form representation we can use linear programming to determine an '
 'optimal strategy for each player We deﬁne a normal form mixed strategy '
 'vector σias a row vector with melements where mis the number of non '
 'weaklydominated pure strategies for player i We wish to ﬁnd the optimal '
 'distribution of all pure strategies for each player For Kuhn Poker we have  '
 'a b c d e f g h  q r s t where each entry represents a strategy for the '
 'respective players as shown in payo ﬀmatrix P  Nashoptimal strategies for '
 'players  and  respectively Note that these could be either pure or mixed '
 'strategies Then',
 'CHAPTER  KUHN POKER  σk  the probability that player  will play a particular '
 'pure strategy k Note that the sum of all of the pure strategy probabilities '
 'must sum to  kσk  kσk   For example a valid pure strategy for player  would '
 'be          and a valid mixed strategy for player  would be     This '
 'particular  always employing PPP PBB  employing PPBPPB and PPBPBB with equal '
 'frequency Note that in both cases the entries of σsum to  as per  LetMas the '
 'normal form payo ﬀmatrix Pwith a constant of  added to each entry to make '
 'each positive Deﬁne zas the expected value of the game with payo ﬀmatrix P '
 'and zas the expected value of the game with payo ﬀ matrix M Both zand zare '
 'from player  perspective The reason for this modiﬁcation of Pwill soon '
 'become clear in short it allows us to deﬁne necessary sign restrictions on '
 'our LP This does not change the optimal strategy as it holds the relative '
 'payo ﬀs between the two players constant However the optimal objective '
 'function value zthat we ﬁnd in the LP will diﬀer from the true expected '
 'value of the game z We later ﬁnd zthrough a diﬀerent method the purpose of '
 'this analysis is to ﬁnd the probabilities',
 ' CHAPTER  KUHN POKER assigned to each pure strategy in an optimal mixed '
 'strategy PPBPPB BPBPPB PPBPBB BPBPBB PPP PPB     PPP PBB     BPP OBB     BPP '
 'OPB     BPBOPO     BPBOBO     PPBPPO     PPBPBO     M   the optimal '
 'strategies for each player and Mis the payo ﬀmatrix for each combination of '
 'those strategies we have    That is the payo ﬀzis the matrix product of each '
 'players mixed strategy σ with the payo ﬀmatrix P Player  optimal strategy  '
 'maximize the minimum of zagainst any of player  pure strategies Since '
 'player  does not know in advance the counterstrategy that player  will use '
 'he wants to employ a strategy that gives the best worstcase scenario payo ﬀ '
 'An arbitrary strategy of player  will have at best expected payo ﬀzagainst '
 'an arbitrary    ',
 'CHAPTER  KUHN POKER  In building our LP model we consider the  pure '
 'strategies of player  These are represented by the vectors                  '
 'respectively for each of the strategies denoted by the columns in  and  We '
 'then ﬁnd   and combine these four sums with the upper bound of zfrom  This '
 'gives the constraints     Dividing by z we have                     '
 'zc          zd ze    ',
 ' CHAPTER  KUHN POKER Then deﬁne ij pas ia zjb z ph z  Since each abhare '
 'probabilities they are all nonnegative Since we modiﬁed the payo ﬀmatrix Pto '
 'have strictly positive entries in M we know that  This gives the sign '
 'restrictions   Combining  and  we have     From  we know that  Thus we have '
 'a zb zh   z  Maximizing ijpwould minimize z which is player  goal By '
 'combining this objective function with the constraints and sign restrictions '
 'we have player  LP ',
 'CHAPTER  KUHN POKER  Minimize zijklmnop subject to      Observe that without '
 'the sign restrictions each variable could be arbitrarily small since this is '
 'a minimization problem we would have an unbounded LP The modiﬁcation of the '
 'payo ﬀmatrix from PtoMwas necessary to guarantee that  which allows us to '
 'deﬁne the appropriate sign restrictions A solution to this LP corresponds to '
 'an optimal  Using the Simplex method we ﬁnd that there are inﬁnitely many '
 'optimal solutions to this LP all with   One such solution is     with all '
 'other variables equal to  Since  a b c d e f g h iz jz kz lz mz nz oz pz  we '
 'can solve these equations to ﬁnd an optimal strategy for player  in terms of '
 'his potential pure strategies This mixed strategy is     and is given        '
 'Note that the sum of the entries in   as required by  These values represent '
 'the probabilities of player  using each of his pure strategies He will use '
 'pure strategy PPPPPB with',
 ' CHAPTER  KUHN POKER   with   and PPBPPO with   This corresponds to the '
 'following mixed strategy In the ﬁrst betting round Player  will bet with   a '
 'Jack always pass with a Queen and bet with   a King On the second betting '
 'round for player  he should always fold a Jack facing a bet call with a '
 'Queen with   and always call with a King The other optimal solutions '
 'prescribe a similar strategy player  should vary blu ﬃng with a Jack and '
 'slowplaying with a King In poker slowplaying involves checking with a good '
 'hand to induce the other player to blu ﬀwith a poor hand',
 'CHAPTER  KUHN POKER   Player  Optimal Strategy We can also compute the Nash '
 'equilibria strategy for player  using a similar Minimax LP method Working '
 'from  we determine the optimal   The pure strategies for player  are given '
 'by the columns in matrix P and are abbreviated as uvwxrespectively Player  '
 'optimal strategy minimizes the maximum of zagainst any of player  pure '
 'strategies This LP is the dual of  Maximize zuvwx subject to          where '
 'uq zvr zws z and xt z This LP has a unique optimal solution    and   This '
 'optimal solution corresponds to      ',
 ' CHAPTER  KUHN POKER These values prescribe the probability with which '
 'player  should utilize each of his pure strategies He should use PPBPPB '
 'with   BPBPBB with   This optimal  to a strategy as follows When holding a '
 'Jack player  should always fold when facing a bet and bet with   player  '
 'checks With a Queen they should call a bet with   always check when facing a '
 'check from player  When holding a King they should always call when facing a '
 'bet or bet when player  checks Now that we have the optimal strategies   we '
 'can ﬁnd the expected value of the game for both the original payo ﬀmatrix '
 'Pand the modiﬁed matrix M This zis the expected value of the game to player  '
 'if each player utilizes strategy For the original case we '
 'have                                   Since    this implies that  ',
 'CHAPTER  KUHN POKER  For the modiﬁed payo ﬀmatrix '
 'case                                                 Since    this implies '
 'that   In both cases we divide the matrix product by  to ﬁnd the average '
 'payo ﬀover all  possible card combinations In the modiﬁed payo ﬀmatrix Mcase '
 'we also subtract  from the zvalue This corrects for the  that we added to '
 'each entry Note that the optimal zvalue is identical in both cases this '
 'shows modifying the payo ﬀmatrix in this way has no eﬀect on the optimal '
 'solution Player  can expect to lose an average   a betting unit to player  '
 'in each hand of Kuhn Poker provided that both players play their optimal '
 'strategies If either plays a nonoptimal strategy this expectation will '
 'change',
 ' CHAPTER  KUHN POKER  Sequence Form The normal form representation provides '
 'a succinct correspondence with an LP particularly for small games However '
 'this model quickly becomes intractable for large games While the normal form '
 'payo ﬀmatrix is generally exponential with the size of the game tree growth '
 'in the sequence form is at most linear  As such the sequence form '
 'representation is more appropriate for larger games This di ﬀerence is not '
 'as apparent in the sequence form representation of Kuhn Poker as it is a '
 'relatively small game This will become more apparent in Chapter  when we '
 'consider a much larger game This section applies the theory of Section  to '
 'Kuhn Poker We deﬁne and solve linear programs to ﬁnd the optimal strategies '
 'as realization plans for each player  Sequences and Information Sets Recall '
 'that a fundamental concept in the sequence form representation is the '
 'information set An information set in an imperfect information game is a set '
 'of possible game states that are identical from the point of view of a '
 'particular player In Kuhn Poker an information set for a player consists in '
 'knowing what card they hold as well as the betting sequence thus far in the '
 'hand They do not know what card their opponent holds Since there is hidden '
 'information throughout the game there are multiple elements in each '
 'information set Note that distinct elements in an information set can '
 'represent very di ﬀerent positions on the game tree Di ﬀerent nodes '
 'represent distinct positions on the game tree but nodes in the same '
 'information set are',
 'CHAPTER  KUHN POKER  identical from that players perspective In Figure  the '
 'pair of red nodes is an information set They represent an information set '
 'for player  where they know that they hold a Jack and no betting has taken '
 'place thus far Player  has identical pieces of information but his place on '
 'the game tree is di ﬀerent as player  holds di ﬀerent cards Note that a '
 'player must have an identical strategy across all nodes in his information '
 'set they have no way to strategically distinguish elements of an information '
 'set and must play uniformly across all Kuhn Poker is an example of an '
 'extensive form game with imperfect information and perfect recall Deal '
 'JQ         mn g hb o pa qr g hb s t Figure  Subtree of Kuhn Poker Sequences '
 'represent an intermediate move within the game tree as opposed to a full '
 'path from the root to a payo ﬀleaf For example the sequence xaof player  '
 'only deﬁnes the action of checking while holding a Jack in the ﬁrst betting '
 'round Each lettered edge in Figure  represents a sequence',
 ' CHAPTER  KUHN POKER Note that each player in Kuhn Poker has a unique set of '
 'sequences given by   iasi  imsi  represents the chance player who '
 'initializes the game at the root by generating a random deal of the cards '
 'for each player  Payo ﬀs We now turn our attention to deﬁning the payo '
 'ﬀmatrix Pin the sequence form representation of Kuhn Poker Since the payo ﬀs '
 'at each leaf are unique to their preceding sequences the payo ﬀfunction gis '
 'well deﬁned There are at most as many sequences as nodes for a particular '
 'player so the number of sequences is linear in the size of the game tree '
 'Since the number of nonzero entries of this matrix is at most the number of '
 'sequences of player i this matrix is sparse Most entries will be  as they '
 'represent combinations of sequences that are not possible and have no '
 'associated payo  Consider  this deﬁnes the payo ﬀto player  checking while '
 'holding a Jack and player  betting while holding a Queen after player  has '
 'bet Since this combination is not possible the payo ﬀis  Examining Figure  '
 'we can see that most combinations of sequences sare impossible and are '
 'assigned a payo ﬀof  by default In Kuhn Poker we consider  to be the payo '
 'ﬀto player  from',
 'CHAPTER  KUHN POKER  Deal JQ     mn g hb o p Figure  Payo ﬀfunction example '
 'with  shown in blue arbitrary sequence   Since this is a zerosum game the '
 'payo ﬀ to player  is simply  For example we have  This represents player  '
 'holding a Jack and checking followed by player  checking while holding a '
 'Queen The hand would then go to showdown and player  would win player  ante '
 'This is shown in blue Figure  We now deﬁne the payo ﬀmatrix P which '
 'represents the payo ﬀfrom player  perspective for each combination of '
 'sequences played Since this is a zerosum game the payo ﬀs from player  '
 'perspective for each combination of sequences is simply P For the '
 'realization plans xand y the payo ﬀs to each player are xTPyandxPyT where '
 'Pis  Each entry in P is given by  Each entry in Pcan be computed as follows '
 'Consider a triple of sequences  that corresponds to a payo ﬀleaf on the game '
 'tree This payo ﬀ',
 ' CHAPTER  KUHN POKER  is multiplied by  which represents the chance '
 'probabilities on the path to the leaf In the case of Kuhn Poker our chance '
 'node representing the random deal of the cards takes each branch a '
 'particular deal with   This product is added to the initial zero matrix at '
 'position  Any combination  sequences that does not correspond to a legal '
 'sequence of moves and has no payo ﬀleaf has a  in its corresponding entry '
 'Since most combinations of sequences are not possible the resulting matrix '
 'is sparse It will have at most as many nonzero entries as leaves of the game '
 'tree Consider the matrix entry   To calculate this we ﬁrst observe that the '
 'payo ﬀof the sequence combination saand  We then multiply this value by the '
 'probability that the players will have an opportunity to play these '
 'sequences That is we consider the chance node outcomes necessary The random '
 'deal of the cards represents the only chance node This sequence combination '
 'can only occur if player  is dealt a Jack and player  is dealt a Queen which '
 'happens with   We multiply this by the direct payo  to ﬁnd   All of the '
 'other entries in Pare calculated by the same method the complete payo '
 'ﬀmatrix Pfor player  is shown in ',
 'CHAPTER  KUHN POKER  θm n o p q r s t u v w '
 'x                                                                                                                                                        '
 'P   Strategy Constraint Matrices and Realization Plans The ﬁnal structures '
 'necessary to construct the sequence form LPs for Kuhn Poker specify the '
 'legal ways to play the game We deﬁne the vectors xand yto be realization '
 'plans with  entries each for each sequence of the respective players Each '
 'entry in xand ycorresponds to a particular sequence sof the respective '
 'players which are the rows and column heading in  two strategy constraint '
 'matrices Eand F which deﬁne xand yas realization plans The vectors pand q '
 'which represent the dual variables in',
 ' CHAPTER  KUHN POKER each LP they have     respectively Finally we have '
 'vectors eand f which are unit vectors of an appropriate dimension that '
 'satisfy Exeand Fyy These elements are based on the properties of realization '
 'plans in   and  The strategy constraint matrices Eand Fdeﬁne the legal '
 'combinations of sequences that each player can choose The dimensions of Eand '
 'Fare      Since each player has  information sets and  sequences both '
 'matrices are   Each row in these matrices represent a particular information '
 'set and each column represents a particular sequence The fact that both '
 'matrices are the same size is a coincidence based on the structure of Kuhn '
 'Poker as both player  and player  happen to have  information sets and  '
 'sequences The ﬁrst row in Eand Frepresents the  information set '
 'corresponding to the random deal and the ﬁrst column represents the sequence '
 'sof the random deal These matrices can be constructed as follows We place a  '
 'in this ﬁrst entry to initialize the game For each subsequent information '
 'set row we place  in the sequence that is required to happen before the '
 'player is in the information set Then we place a  in each sequence in the '
 'information set For example sequence samust occur before player  can be in '
 'information set  where he can choose to play sequence gorh Since the '
 'previous move for player  is the random deal θ each information set row in '
 'Finitializes with a  atθ Using this process we have Eand Fas shown in  and ',
 'CHAPTER  KUHN POKER  θ a b c d e f g h i j k '
 'l                                                                                              '
 'E  θ m n o p q r s t u v w '
 'x                                                                                             '
 'F   Player  Optimal Strategy We now have all of the necessary theory and '
 'structures to write the sequence form representation of Kuhn Poker Recall '
 'from Section  that',
 ' CHAPTER  KUHN POKER player  optimal realization plan is the solution to '
 'Minimize fxqqTf subject to  xTETeT  With the structures deﬁned in the '
 'previous sections our LP is Minimize  subject '
 'to                                     ',
 'CHAPTER  KUHN POKER               Using Mathematicas builtin LP solvers we '
 'ﬁnd the optimal solution                         This optimal realization '
 'plan directly corresponds to an optimal behavioral strategy Each optimal '
 'xvalue corresponds to the frequency with which player  should utilize the '
 'corresponding sequence s For each information set the x values represent a '
 'probability distribution For example consider the optimal values  and  These '
 'values correspond to the sequence saand sb which represent player  choice of '
 'checking or betting when holding a Queen after player  has checked on the '
 'ﬁrst betting round In this optimal',
 ' CHAPTER  KUHN POKER strategy player  should always choose sequence sa This '
 'makes intuitive sense if player  bets in this situation player  will always '
 'call the bet when holding a King and fold when holding a Jack In both cases '
 'player  is better oﬀchoosing not to bet The action of player  betting while '
 'holding a Queen after player  has checked to him is an example of a '
 'weaklydominated action This solution does not prescribe a pure strategy for '
 'every information set instead optimal strategy sometimes prescribes a mix of '
 'actions For example consider     The corresponding sequences represent '
 'player  betting choice when holding a Queen and player  has just bet Optimal '
 'strategy dictates that player  should pass with   bet with   The '
 'nondeterministic strategy in that information set means that the optimal '
 'strategy for player  is a mixed strategy In addition to describing the '
 'optimal strategy for player  the solution to this LP also shows the value of '
 'Kuhn Poker from player  perspective The value of the game is the optimal '
 'objective function value which in this case is simply   Note that this is '
 'identical to the optimal zvalue found using the normal form LPs In each hand '
 'of Kuhn Poker player  can expect to lose   a betting unit Note that this is '
 'player  expectation only if both players utilize their Nash optimal '
 'strategies if either deviate his expectation can change signiﬁcantly It is '
 'not surprising that optimallyplayed Kuhn poker inherently favors player  it '
 'is well known that players who act after their opponent hold an advantage '
 'This is a concept known as position and is particularly important in poker '
 'variants with more rounds of betting',
 'CHAPTER  KUHN POKER   Player  Optimal Strategy To ﬁnd the optimal strategy '
 'for player  we solve the dual of player  LP This LP is given by Minimize '
 'fypeTp subject  Fyf  This corresponds to the following LP where each '
 'ycorresponds to a particular sequence s  subject '
 'to                             ',
 ' CHAPTER  KUHN POKER                      While player  has a single optimal '
 'strategy player  has inﬁnitely many optimal strategies Mathematicas Linear '
 'Programming function has three optional methods to compute numerical '
 'solutions Simplex Revised Simplex and Interior Point The ﬁrst two methods '
 'compute the endpoint solutions while Interior Point ﬁnds the midpoint '
 'solution With these methods we can characterize all possible optimal '
 'strategies These are reported as behavior strategies with a probability '
 'distribution deﬁned on each information set The value of each yis the '
 'probability that player  should utilize the corresponding sequence swhen in '
 'the relevant information set The particular pvalues are unimportant in this '
 'analysis These results are shown in Table  As these results demonstrate '
 'player  has inﬁnitely many optimal',
 'CHAPTER  KUHN POKER  Simplex Interior Point Revised Simplex y    ya    yb    '
 'yc    yd    ye   yf   yg    yh            yk    '
 'yl                               Table  Solutions to Player  LP',
 ' CHAPTER  KUHN POKER strategies Since the Simplex and Revised Simplex '
 'solutions represent the endpoint solutions all intermediate solutions are '
 'also optimal We can characterize player  optimal strategies as dependent on '
 'a parameter   which is the probability that they will bet on their ﬁrst turn '
 'while holding a Jack When holding a King player  should bet with '
 'probability  α on their ﬁrst turn When holding a Queen player  should always '
 'check on their ﬁrst betting round If player  bets after this check player  '
 'should call the bet with probability   Finally player  should always fold a '
 'Jack and call with a King when facing a bet from player  Unlike player  LP '
 'solution  player  LP solution does not correspond neatly to a behavioral '
 'strategy Recall that the optimal values calculated by the sequence form LP '
 'describe a realization plan which are relative to the realization '
 'probability of an information set Consider that player  will not always have '
 'a second choice to bet this only occurs when he checks and player  bets '
 'There are many other paths down the game tree that do not involve these '
 'moves such as both players checking or player  folding to player  bet Since '
 'player  always faces a decision to check bet or fold regardless of player  '
 'action the sum of each pair of sequences sfor each information set is  The '
 'same is not true for player  who will not always get to play sequences '
 'sgthrough sl Consider the optimal   the Interior Point solution   Since '
 'player  potential later choice between sgand sl is dependent on him also '
 'playing   the solution to the LP We use a similar process to convert each of '
 'the values in the realization plan to a full behavioral strategy In a sense '
 'the probability of the base sequence   becomes the new  for its subsequent '
 'sequences further down the game tree',
 'CHAPTER  KUHN POKER  In player  optimal realization plan some sequences will '
 'never be used Consider the sequences skand sl both with realization '
 'probability  in the Revised Simplex solution Both are members of the same '
 'information set in which player  was dealt a King checked initially and now '
 'faces a bet from player  However he will never reach this information set if '
 'he plays according to other elements of his optimal realization plan In the '
 'Revised Simplex solution  that is he never checks initially while holding a '
 'King Since seis necessary for both skand sl he will never face the choice '
 'Therefore an optimal realization plan does not have to specify frequencies '
 'for these actions Table  shows the optimal realization plan converted to an '
 'optimal behavior strategy as above with denoting sequences that are never '
 'reached The Simplex solution represents the case  In this case player  '
 'always checks in the ﬁrst round that is  and  Since he chooses to never blu '
 'ﬀby betting when holding a Jack he must balance his strategy by also never '
 'betting a King for value He must call a bet from player  while holding a '
 'Queen with   The Revised Simplex method gives the other endpoint solution '
 'with   In this strategy player  bluﬀs with a Jack with    and always value '
 'bets with a King  He always checks with a Queen in the ﬁrst round  and calls '
 'a bet from player  with    In all optimal strategies player  folds with a '
 'Jack and calls with a King when facing a bet He cannot win a showdown with a '
 'Jack and cannot lose a showdown with a King thus any strategy that did not '
 'prescribe these sequences is weakly dominated by those that do The Simplex '
 'solution  represents player  most conservative strategy as he never blu ﬀs '
 'with a Jack and never value bets with',
 ' CHAPTER  KUHN POKER a King Conversely the Revised Simplex solution   '
 'represents player  most aggressive strategy as he frequently blu ﬀs with a '
 'Jack and always value bets with a King Simplex Interior Point Revised '
 'Simplex s    sa    sb    sc    sd    se   sf   sg    sh            sk   sl   '
 'Table  Player  Optimal Behavioral Strategy',
 'Chapter   Draw Poker Although Kuhn Poker serves as a useful example in '
 'understanding concepts in game theory and the method of the sequence form it '
 'bears little resemblance to actual variants of poker Other variants play '
 'with more cards more betting rounds and more players In turn these games are '
 'much more complex to analyze for comparison  nolimit Texas Holdem has '
 'approximately  sets  That is many more atoms than exist in the known '
 'universe While games of this size are signiﬁcantly beyond the capabilities '
 'of this approach we are able to analyze abstracted versions of more complex '
 'games In this chapter we develop an abstracted version of  Draw poker and '
 'use the sequence form LP methodology to determine an optimal strategy  Rules '
 'While poker variants such as Texas Holdem and Omaha have become very popular '
 'in recent years variants such as  Draw still have a loyal ',
 ' CHAPTER   DRAW POKER following Its structure and game play are very di '
 'ﬀerent and little previous work has been published on gametheoretic optimal '
 'play As such it is a fruitful area of research This section details the '
 'rules of fullscale two player  Draw based on   Draw is a lowball variant '
 'meaning that traditional hand rankings are reversed the worst traditional '
 'hand wins the pot if the hand goes to showdown Additionally as the name '
 'suggests it is a draw variant Each player is dealt a private hand and has '
 'the opportunity to discard and redraw any number of their own cards after '
 'each betting round These features contrast with games such as Texas Holdem '
 'and Omaha where players share a common set of community cards and the '
 'highest hand wins At the start of each hand each player is dealt  cards '
 'There is a round of betting where each player has the option to check bet '
 'raise or fold depending on the actions of previous players Betting in  Draw '
 'games can have a limit structure with ﬁxed bet sizes or a nolimit betting '
 'structure where players can bet any amount Then each player discards any or '
 'all of their hand and replaces them with cards from the deck  Draw is most '
 'commonly played with one or three discard rounds our version uses one '
 'discard round If there is more than one person who has not previously folded '
 'the hand goes to showdown and the player with the worst hand wins the pot '
 'Thus a hand of  Single Draw has the following structure  cards are dealt to '
 'each player  round   and redraw up to  cards  round ',
 'CHAPTER   DRAW POKER   if necessary Hand rankings in  Draw are reversed in '
 'comparison to poker variants such as Texas Holdem and Omaha From best to '
 'worst they are as follows  Pair  Pair  Pair  of a Kind    House  of a Kind  '
 'Flush  Flush Within each of these categories there is a further ordering The '
 'best possible No Pair hand is      not of the same suit The best possible '
 'One Pair hand is      which is worse than all No Pair hands Ordering in each '
 'category is determined ﬁrst by the highest card or pair and subsequently by '
 'the next highest card For example      beats      Each category admits a '
 'similar ordering structure',
 ' CHAPTER   DRAW POKER  Abstractions In order to analyze a poker variant '
 'using the sequence form LP method it is necessary to reduce the size of the '
 'game There are several types of these abstractions all of which aim to '
 'simplify the game without losing the underlying strategy The abstractions '
 'that we use to simplify  Draw are outlined in this section and are based on '
 'ideas from   Deck Reduction One abstraction technique to reduce the size of '
 'the game is to reduce the number of cards in the deck This simpliﬁes the '
 'game by drastically reducing the number of potential hands and by extension '
 'the size of the game tree For example a  card deck has    unique  card hands '
 'In using this type of abstraction it is important to choose a deck size that '
 'maintains an equivalent ordering of hand strengths In other words the '
 'frequencies of each hand category must remain generally consistent between '
 'the original game and the abstraction For example One Pair must be more '
 'common than a Straight which in turn must be more common than a Flush To '
 'accomplish this we experimented with several combinations of deck size and '
 'hand size We settle on a  card deck with  card hands for each player This '
 'deck contains the cards  through  of each of',
 'CHAPTER   DRAW POKER  three suits clubs spades and hearts This deck has    '
 'unique  card hands The hand rankings for this abstraction and their relative '
 'frequencies are shown in Table  While these hand rankings do not correspond '
 'precisely to the original game they retain enough similarity to make valid '
 'strategic comparisons between the two games Hand Type Example Combinations '
 'Probability Three of a Kind    Straight Flush    Flush    Straight    '
 'Pair    High Card    Table  Hand Rankings with Frequencies in Simpliﬁed  '
 'Draw Poker  Betting Abstractions We can also simplify the game by changing '
 'the number and structure of betting rounds In a typical game of  Triple Draw '
 'there are up to three opportunities provided at least two players do not '
 'fold for players to discard and obtain new cards Players can discard and '
 'redraw up to  cards each time Before the ﬁrst and following every discard '
 'there is a round of betting in which players can either bet a ﬁxed amount or '
 'any amount  Draw can be played as a limit or nolimit game respectively Each '
 'round of betting and subsequent discard exponentially increases the size of '
 'the game tree We simplify this by allowing a single discard round',
 ' CHAPTER   DRAW POKER preceded and followed by a round of betting '
 'Additionally we specify that each player must discard exactly one card While '
 'this discard rule is a signiﬁcant deviation from the original rules it is '
 'necessary for our game to be tractable Additionally we suggest that this '
 'does not deviate radically from actual strategy it would be unusual for a '
 'player to receive such a good hand in the original deal that they have no '
 'desire to draw any cards It is not possible to give this a precise '
 'probability it would depend on the players strategy and their opponents '
 'strategy Additionally we impose a limit betting structure with no raises '
 'possible This is identical to the betting structure of Kuhn Poker In each '
 'betting round player  ﬁrst decides to check or bet If player  checks player  '
 'can also check or bet If player  bets player  must fold or call If player  '
 'bets originally player  must fold or call The elimination of raising where '
 'one player increases the previous bet represents a signiﬁcant strategic '
 'deviation in our simpliﬁed game Raising gives players more opportunities to '
 'blu ﬀand win the pot  Bucketing The most important abstraction technique is '
 'known as bucketing where each possible hand is partitioned into one of '
 'several equivalence classes buckets through a manytoone mapping function '
 'Instead of considering the optimal strategies for individual hands we group '
 'them by strategic similarity and ﬁnd the optimal strategy for playing each '
 'bucket as a whole If the hands are grouped into buckets in a cogent way all '
 'hands in a bucket can be played identically without signiﬁcant issue  Note '
 'that each of these sets',
 'CHAPTER   DRAW POKER  of buckets are particular to the game state in our '
 'case there is one set of buckets for hands determined by the initial deal '
 'and another for hands after the discard round The most intuitive method of '
 'bucketing is by raw hand strength that is by the absolute hand rank relative '
 'to all possible hands Using this method bucket composition would be '
 'determined by simply partitioning the ordered set of all possible hands into '
 'some number of equivalence classes This is an appropriate method for the '
 'second set of buckets when no new cards will be drawn However this method '
 'loses any conception of hand potential which is critical in early stages of '
 'the hand A player may be initially dealt a hand with poor absolute hand '
 'strength but with a high probability of improving signiﬁcantly during the '
 'discard round This hand is said to have high rollout hand strength '
 'Conversely a hand with poor rollout hand strength has little chance of '
 'improving to a absolutely strong hand after the discard and redraw Thus we '
 'categorize the ﬁrst set of buckets according to rollout hand strength and '
 'the second according to absolute hand strength The process of determining '
 'bucket composition is detailed further in Section  In both sets of buckets '
 'the number of member hands is not uniform Buckets representing hands of '
 'middling strength are larger and buckets representing very strong or very '
 'weak hands are smaller This is done in order to better discriminate hands '
 'that should be played very aggressively or those that should be folded early '
 'in the hand The sizes and characteristics of the respective buckets are '
 'shown in Table  Given the computational restrictions of Gambit we develop '
 'simpliﬁed games with  and  initial buckets each with  ﬁnal buckets The ﬁrst '
 'set of initial buckets are denoted A',
 ' CHAPTER   DRAW POKER Bucket Size of hands Example Hand A   B   C   D   E   '
 'Table  Initial Buckets Bucket Size of hands Example Hands          Table  '
 'Final Buckets and B the second set C D and E and the set of ﬁnal buckets    '
 'The best initial buckets are A and C and the best ﬁnal bucket is  Finally we '
 'need sets of transition probabilities that model the move into the initial '
 'buckets from the original deal and from the initial to the ﬁnal buckets In '
 'this abstract game there are no individual cards only buckets The eﬀect of '
 'the original deal node is to determine the probability of initialization to '
 'each pair of initial buckets Likewise the e ﬀect of the discard round is to '
 'determine the probability of moving from one pair of initial buckets to one '
 'pair of ﬁnal buckets Conceptualizing the game in this way drastically '
 'reduces the number of nodes instead of      possible initial deals there are '
 'only  or  bucket combinations depending on the model The ﬁrst set of '
 'transition probabilities is an nnmatrix where nis the',
 'CHAPTER   DRAW POKER  Bucket A Bucket B Bucket A   Bucket B   Figure  '
 'Initial Transition Probabilities to  Buckets Bucket C Bucket D Bucket E '
 'Bucket C    Bucket D    Bucket E    Figure  Initial Transition Probabilities '
 'to  Buckets number of initial buckets Since each matrix represents a '
 'probability  where each aijis the matrix entry representing the probability '
 'of player  being dealt a hand in the ith bucket and player  being dealt a '
 'hand in the jth bucket Since each player has an equal likelihood of '
 'receiving a particular hand transition matrices are symmetric that is aijaji '
 'for all ij For computational feasibility our simulations iterate over a '
 'subset of all possible hand combinations Therefore the matrices shown in '
 'Figures  and  are only approximately symmetric The second set of transition '
 'probabilities is an nn to mm transition network where mis the number of ﬁnal '
 'buckets In these  each column represents a probability distribution That is  '
 'where each bijis the matrix entry representing the probability that the '
 'players move from initial bucket combination jto ﬁnal bucket combination '
 'iwith the discard round Each ordered pair represents the pair of buckets '
 'each players hand is in respectively For example the transition probability '
 'from state AA to  is  This is interpreted as follows given that both players '
 'are',
 ' CHAPTER   DRAW POKER A A A B B A B '
 'B                                                       Figure  Final '
 'Transition Probabilities from  Buckets C C C D C E D C D D D E E C E D E '
 'E                                                                                                    '
 'Figure  Final Transition Probabilities from  Buckets initially dealt hands '
 'in bucket A the probability that they will both have hands in bucket  after '
 'the discard round is   Simulation An important element of our simpliﬁed '
 'version of  Draw is the transition probabilities between each game state '
 'conceived as the associated buckets of each players hand Recall that in this '
 'game we do not consider individual hands as nodes in the game tree only '
 'pairs of buckets However',
 'CHAPTER   DRAW POKER  the probability of the game being in each of these '
 'bucket combination states is not uniform Therefore we must determine the '
 'individual transition probabilities between each bucket pairing through '
 'simulation This section presents an overview of the algorithms necessary to '
 'model this and other elements of the game before we use the sequence form LP '
 'method to ﬁnd the optimal strategy All of the following code was written in '
 'Python The ﬁrst step is to generate an ordered list of all possible  card '
 'hands based on hand strength There are    total hands The ordering of the '
 'hands has two levels First we place the hands into the ranking categories '
 'shown in Table  such as Three of a Kind Flush One Pair etc This is done '
 'through conditional statements based on card values and suits of each hand '
 'Within each of these categories we then sort based on the highest card in '
 'the hand to create a sub ordering This process is repeated for each ranking '
 'category and the ordered categories are appended to an overall list '
 'OrderedHands Algorithm  shows a schemitization of this process for the Three '
 'of a Kind category forAllHands do    then AppendHand to ThreeKindList end '
 'end SortThreeKindList AppendThreeKindList to OrderedHands Algorithm  Hand '
 'Sorting Algorithm',
 ' CHAPTER   DRAW POKER Recall that the particular hand composition of our '
 'initial buckets is based on the rollout strength of each hand given all '
 'possible draw possibilities We iterate each hand over all possible draws and '
 'determine the average ﬁnal hand ranking based on its index in OrderedHands '
 'In order to determine which card to discard we use the following rule if '
 'their hand is a pair or three of a kind discard one those cards Otherwise '
 'discard the highest card in the hand A general version of this process is '
 'shown in Algorithm  First we remove each of the three cards in the original '
 'hand from the available Deck since players cannot redraw a card that they '
 'discard Then if the original hand is a Pair or Three of a Kind '
 'PairsThreeKind that card is replaced with one from the Deck Otherwise the '
 'highest card is replaced with one from the Deck We then ﬁnd the Strength of '
 'the new hand given by its index in the OrderedHands This process iterates '
 'for each of the  possible cards to be drawn Then for each hand we compute '
 'the average Strength and place the hand into a bucket with similar Strength '
 'values',
 'CHAPTER   DRAW POKER  forOrderedHands do Hand       from Deck forDeck do '
 'ifHand in PairsThreeKind then Replace PairCard with Deck i end else Replace '
 'HighCard with Deck i end Strength OrderedHandsindexNewHand end '
 'ifAverageStrength value then AppendHand to BucketA end else AppendHand to '
 'BucketB end    to Deck end Algorithm  RollOut Hand Strength Algorithm Now '
 'that we have deﬁned the composition of individual buckets following the '
 'initial deal we can determine the frequency of each pair of bucket '
 'combinations for each player For example we want to determine the '
 'probability that both players will have a hand in bucket A after the initial '
 'deal For each of the  possible Hands ﬁrst remove each card from the '
 'remaining',
 ' CHAPTER   DRAW POKER Deck Then generate each  card combination of the Deck '
 'as the list structure Combos For each of these the ordered pair HandPair is '
 'the combination of the original Hand and an element of Combos This pair of '
 'two hands is then sorted into the appropriate paired bucket based on the '
 'original membership of each of its component hands For example if both Hand '
 'and a particular element of Combos were originally members of bucket A '
 'deﬁned in Algorithm  this HandPair would be appended to BucketAA Then the '
 'probability that BucketAA is reached after the initial deal  Length BucketAA '
 'A generalized version of this process is shown in Algorithm  forHands do '
 'Hand       from Deck Combos CombinationsDeck  SortCombos forCombos do '
 'HandPair Hand Combos end    to Deck end ifHand in BucketA and Combos in '
 'BucketA then AppendHandPair to BucketAA end LengthBucketAA Algorithm  '
 'Initial Bucket Probability Algorithm We now turn our attention to the second '
 'set of buckets representing game states after each player has discarded and '
 'redrawn Their hand is now ﬁxed',
 'CHAPTER   DRAW POKER  and we can consider a new set of buckets based only on '
 'the strength of their hand These buckets are deﬁned in Table  and we deﬁne '
 'these in our code by iterating over all   twoplayer hand combinations and '
 'sorting based on the respective indices in OrderedHands The result is a set '
 'of  list structures   etc which contain pairs of hands meeting the criteria '
 'for each single hand bucket For example if both players held a hand in the '
 'top  of overall hands it would be placed in  With this second set of buckets '
 'deﬁned we now determine the transition probabilities for moving between each '
 'ﬁrst round bucket pair deﬁned in Algorithm  and each second round bucket '
 'pair This is the most computationally intensive step of this simulation '
 'process and required timesaving measures at multiple points This algorithm '
 'is shown in generalized form in Algorithm  First we initialize a counter  '
 'representing the number of hand pairs that fall into  For each hand pair in '
 'BucketAA remove each of the six cards that one of the players holds from the '
 'available Deck Then generate all permutations of Deck of length  This is an '
 'ordered pair representing the cards that each player will receive after they '
 'discard one card respectively For computational e ﬃciency randomly select '
 'one of these and assign it to Draw Then replace one card in each players '
 'hand with one of the cards in Draw The particular card to be replaced is '
 'determined by the same discard rule if holding One Pair or Three of a Kind '
 'discard one of those cards Otherwise discard the highest card With the '
 'resulting pair of hands check the membership of each in the previously '
 'deﬁned ﬁnal buckets and increment the corresponding counter For example if '
 'the both of the hands are in the strongest category in ',
 ' CHAPTER   DRAW POKER after the particular Draw add  to  ThenCounter   the '
 'approximate probability that given original membership in BucketAA the '
 'players will end  after the discard and redraw This value has a '
 'corresponding entry in Figure  or  for the  and  initial bucket cases '
 'respectively   forBucketAA do HandPair               Remove       from Deck '
 'Draws PermutationsDeck  Draw RandomSampleDraws   in PairsThreeKind and  in '
 'PairsThreeKind then Replace  with  and  with  else if  in PairsThreeKind '
 'and  not in PairsThreeKind then Replace  with  and  with  else if  not in '
 'PairsThreeKind and  in PairsThreeKind then Replace  with  and  with  else '
 'Replace  with  and  with  FinalPair   ifFinalPair in  then    end       to '
 'Deck Algorithm  First to Second Round Transition Probabilities Algorithm',
 'CHAPTER   DRAW POKER   Results We solve the sequence form LP of Simpliﬁed  '
 'Draw using the Gambit software package for both the  and  initial bucket '
 'cases The solutions to these LPs are the optimal realization plans for each '
 'game These LPs also compute an expected value of the game which is simply '
 'the optimal objective function value Gambits sequence form LP algorithms '
 'compute only one optimal solution there may be other optimal realization '
 'plans for Simpliﬁed  Draw This section provides a brief discussion of '
 'Gambits computed solution for more detail see Appendix B   Initial Buckets '
 'For the  initial bucket case both players optimal realization plans '
 'characterize a relatively conservative strategy We begin by discussing '
 'player  optimal play Player  is ﬁrst dealt a random hand which is a member '
 'of either Bucket A or Bucket B Hands in Bucket A have a higher average '
 'rollout hand strength than hands in Bucket B On his ﬁrst opportunity to bet '
 'player  should always check If player  bets after player  checks player  '
 'should always call the bet Thus player  strategy for the ﬁrst round is '
 'simple regardless of Bucket check and call a bet if necessary After the ﬁrst '
 'round of betting each player discards and redraws one card from the '
 'remaining deck At this point player  optimal realization plan becomes more '
 'complicated It deﬁnes optimal play for each combination of original bucket '
 'and ﬁnal bucket Recall that in the ﬁnal round hands are sorted by absolute '
 'strength into Buckets   in ascending order Hands in',
 ' CHAPTER   DRAW POKER Bucket  are superior to those in Bucket  which are in '
 'turn superior to those in Bucket  If player  hand was originally in Bucket A '
 'and both players checked in the ﬁrst betting round he should bet with '
 'probability  while holding a hand in Bucket  always check with Bucket  and '
 'always bet with Bucket  If he does check and player  then bets player  '
 'should always fold with Bucket  and always call with Bucket  Notice that '
 'this optimal realization plan does not specify what player  should do with a '
 'hand in Bucket  after player  has bet since it is optimal for player  to '
 'always bet with Bucket  initially he will simply never be in this situation '
 'These irrelevant sequences are denoted in the full table of results in '
 'Appendix B If player  hand was originally in Bucket A and the betting '
 'sequence of the ﬁrst round was player  checks player  bets and player  calls '
 'player  should bet with probability  while holding a hand in Bucket  always '
 'check with Bucket  and always bet with Bucket  If player  checks and player  '
 'bets player  should always fold with Bucket  and always call with Bucket  If '
 'player  hand was originally in Bucket B and both players checked in the ﬁrst '
 'round player  should always check with Bucket  bet with probability  with '
 'Bucket  and always bet with Bucket  If player  checks and player  bets '
 'always fold with Bucket  and call with Bucket  If player  hand was '
 'originally in Bucket B and the betting sequence of the ﬁrst round was '
 'player  checks player  bets and player  calls player  should always bet with '
 'Bucket  check with Bucket  and always bet with Bucket  If player  checks and '
 'player  bets always call with Bucket  Player  ﬁrst round strategy is more '
 'aggressive and complex than player  If player  checks player  should always '
 'check with Bucket A and always',
 'CHAPTER   DRAW POKER  bet with Bucket B If player  bets player  should call '
 'with probability  with Bucket A and always call with Bucket B The discard '
 'and redraw follows this round of betting If player  originally had a hand in '
 'Bucket A and both players checked in the ﬁrst round and player  bets in the '
 'ﬁnal round player  should always fold with Bucket  call with probability  '
 'with Bucket  and always call with Bucket  Since player  never checks in the '
 'ﬁrst round with Bucket B we need not deﬁne a realization plan for the second '
 'round If player  originally had a hand in Bucket B the ﬁrst round betting '
 'action was player  checks player  bets and player  calls and player  checks '
 'after the discard and redraw player  should always bet with Bucket  bet with '
 'probability  with Bucket  and always bet with Bucket  Instead if player  '
 'bets player  should call with probability  with Bucket  and always call with '
 'Buckets  and  If player  originally had a hand in Bucket A the ﬁrst round '
 'betting action was player  bets and player  calls and player  bets after the '
 'discard and redraw player  should call with probability  with Bucket  always '
 'with Bucket  and with probability  with Bucket  If player  checks player  '
 'should always check with every Bucket If player  instead originally had a '
 'hand in Bucket B he should always call with Buckets  and  and with '
 'probability  with Bucket  If player  checks player  should always check with '
 'every Bucket When each player uses these optimal realization plans the value '
 'of the game is approximately   This value is from player  perspective for '
 'each hand of Simpliﬁed  Draw played according to these optimal realization '
 'plans player  can expected to   units to player  Recall that the',
 ' CHAPTER   DRAW POKER value of optimallyplayed Kuhn Poker is   In Simpliﬁed  '
 'Draw player  has an even greater advantage than in Kuhn Poker This is likely '
 'due to an even greater positional advantage player  acts second on two '
 'rounds of betting instead of only one In each round player  can observe '
 'player  actions before making his own decision Some parts of these optimal '
 'realization probabilities are surprising while others square with previous '
 'intuition about poker strategy The most surprising results are player  '
 'optimal probabilities in the ﬁnal betting round after a ﬁrst round in which '
 'the betting action was player  bets and player  calls In this situation the '
 'LP results dictate that player  should sometimes fold while facing a bet and '
 'always check back while holding a hand in Bucket  This is extremely '
 'suprising since Bucket  is the strongest possible bucket player  can never '
 'outright lose the hand Therefore we would expect that he should want to bet '
 'as much as possible The reason for this prescribed strategy is not clear it '
 'may be a coding error or an inherent issue related to the structure of the '
 'game However the majority of these optimal realization plans are congruent '
 'with our intuitive sense of poker strategy For example player  consistently '
 'folds a poor hand from Bucket  and calls a strong hand from Bucket  when '
 'facing a bet in the ﬁnal round For the most part each player follows a '
 'strategy of betting with a combination of blu ﬀs Bucket  and strong hands '
 'Bucket  In addition they often call with medium strength hands Bucket  '
 'hoping that their opponent is blu ﬃng These strategies are similar to those '
 'in Kuhn Poker Buckets  and  play similarly to a Jack Queen and King '
 'respectively',
 'CHAPTER   DRAW POKER  Finally it is notable that little folding should occur '
 'in the ﬁrst betting round Player  folds with probability   when holding a '
 'hand in Bucket A when player  bets Otherwise each players optimal '
 'realization plan involves always remaining in the hand until the ﬁnal '
 'betting round This highlights the importance of the discard and redraw phase '
 'where each players hand strength can change dramatically Each initial '
 'buckets contained plenty of hands that could become very strong after the '
 'discard and redraw this was simply more likely with Bucket A This feature '
 'illustrates a considerable issue with the abstraction techniques that we '
 'used to reduce  Draw to a tractable size It is likely that more speciﬁc '
 'buckets a bigger deck bigger individual hands and more betting rounds would '
 'incentivize players to fold more often before the ﬁnal betting round   '
 'Initial Buckets We hypothesized that a di ﬀerent version of Simpliﬁed  Draw '
 'with an additional bucket in the ﬁrst betting round would provide a more '
 'robust set of initial betting strategies However the computational limits of '
 'the Gambit software package made this di ﬃcult When solving a sequence form '
 'LP Gambit allows the user to specify computation using rational or '
 'nonrational values The rational method is more accurate but the computation '
 'time required is much greater One of Gambits developers notes that the use '
 'of ﬂoating point arithmetic can lead to numerical instability and strongly '
 'recommends using the rational algorithm  We initially attempted to solve '
 'our  initial bucket model using the rational method after  days the program '
 'did not output a solution It is not',
 ' CHAPTER   DRAW POKER clear how long a game of this size would take to run '
 'but we were surprised that the algorithm could not ﬁnish The  initial bucket '
 'LP with  information sets computed a solution rationally within  minutes and '
 'the  initial bucket LP only has  information sets Fortunately the '
 'nonrational algorithm for the  initial bucket LP ﬁnishes within an hour '
 'However these results are clearly ﬂawed and are shown in Appendix B Many of '
 'the supposed optimal probabilities cannot even be such they often do not sum '
 'to  in each information set are negative or are greater than  We report '
 'these results for the sake of completeness of the project but they cannot '
 'accurately describe an optimal realization plan for the game Future versions '
 'of Gambit and more powerful computers may be able to ﬁnd the exact rational '
 'solution',
 'Chapter  Conclusion This Independent Study is an exposition of the use of '
 'linear programming and game theoretic techniques to ﬁnd optimal poker '
 'strategies Game theory represents games in a variety of forms some of which '
 'can be used to ﬁnd the Nash equilibrium strategies using linear programming '
 'techniques In particular we used the sequence form representation to ﬁnd '
 'Nashoptimal strategies for Kuhn Poker and a novel simpliﬁed version of  Draw '
 'The Gambit software package was a critical tool in both constructing and '
 'solving the sequence form LPs The particular optimal strategies for '
 'Simpliﬁed  Draw are less robust than we hoped they prescribe a relatively '
 'simple strategy for both players These strategies may not be particularly '
 'applicable to the actual game of  Draw given the degree of abstraction and '
 'simpliﬁcation necessary in our model These results could be extended in '
 'several ways For example we could consider a version of Simpliﬁed  Draw that '
 'uses more buckets more rounds of betting or more cards Any of the '
 'abstraction techniques presented ',
 ' CHAPTER  CONCLUSION in Section  could be modiﬁed to create a more realistic '
 'game While our version is a reasonable approximation it loses many key '
 'facets of the game For example players are not actually required to discard '
 'and redraw a card at every opportunity nor by our speciﬁc discard rule Thus '
 'a natural extension of this project is to analyze a version with fewer '
 'abstractions Computational constraints played a signiﬁcant role in our '
 'analysis of Simpliﬁed  Draw and considering a more accurate version would '
 'require better computational tools The current version of Gambit can compute '
 'solutions for mediumsized games like ours but quickly fails when faced with '
 'truly largescale games The current version of Gambit is unable to ﬁnd '
 'optimal strategies of large games using the sequence form LP method but may '
 'be able to using other methods Although not discussed or utilized in this '
 'project Gambit does have a variety of other methods of ﬁnding optimal '
 'strategies  Building the sequence form LPs manually instead of automatically '
 'with Gambit would be di ﬃcult and prone to error However they could be '
 'solved using external solvers which are much more able to handle large LPs '
 'For example a sequence form LP with over   million variables was used to '
 'solve an abstracted game of Rhode Island HoldEm with external LP solvers  '
 'Future work based on computational improvement could use a more advanced '
 'version of Gambit a di ﬀerent solution method or external LP solvers',
 'Appendix A Gambit The primary computational tool used in this project is '
 'Gambit an opensource library of game theory tools  It allows construction of '
 'ﬁnite strategic and extensive games using both an intuitive graphical user '
 'interface GUI and a set of commandline tools for larger games These tools '
 'allow the full speciﬁcation of a game including players actions strategies '
 'information sets etc In addition Gambit has a variety of solution algorithms '
 'that compute the Nash equilibrium of a given game Most relevant to this '
 'project is its sequence form LP method which converts an extensive form game '
 'to sequence form and solves an LP based on the theory of  The author of this '
 'paper Bernhard von Stengel was directly involved in the development of '
 'Gambit Figure  shows a portion of the Kuhn Poker extensive form game tree '
 'constructed in the Gambit GUI It allows the user to specify and label '
 'players actions nodes information sets and payo ﬀs Since Kuhn Poker is '
 'relatively small we compute the Nash equilibrium both using the sequence '
 'form LP ',
 ' APPENDIX A GAMBIT Figure  Part of the Extensive Form of Kuhn Poker in the '
 'Gambit GUI method in Gambit and by building the LP manually and solving in '
 'Mathematica Gambit can also generate and calculate the equilibria for normal '
 'form games albeit with a di ﬀerent methodology Although greatly simpliﬁed '
 'relative to the original game our version of  Draw is much too large for the '
 'GUI to construct and analyze The version with  initial buckets has  '
 'information sets  sequences and  total nodes while the version with  initial '
 'buckets has  information sets  sequences and  total nodes Building a game of '
 'this size graphically causes the program to crash Fortunately Gambit o ﬀers '
 'a set of commandline Python tools that perform the solution algorithms on a '
 'game manually designed and imported through an external text ﬁle Designing a '
 'text ﬁle to accurately describe the game of Simpliﬁed  Draw Poker was a '
 'signiﬁcant undertaking within this overall project The Gambit websites '
 'describes the speciﬁc format for an extensive form game efg text ﬁle '
 'representing each player chance or terminal node as a line with particular '
 'actions payo ﬀs information sets etc The required formatting is',
 'APPENDIX A GAMBIT  very speciﬁc and is described in more detail on Gambits '
 'website To generate this efg text ﬁle we utilize an original Python script '
 'that utilizes several types of symmetry present in the game tree Since the '
 'betting structure is uniform across di ﬀerent bucket combinations '
 'appropriate forloops can be used to iterate over the entire game tree These '
 'ﬁles also specify the transition probabilities for each chance node as '
 'detailed in Sections  and  These scripts are developed for both the  and  '
 'initial bucket cases The results of the scripts are text ﬁles that are  and  '
 'lines respectively These text ﬁles are then imported to an installed Python '
 'environment containing Gambits solver algorithms and other commands The '
 'gambitnashlp solve command generates and solves the sequence form LP and '
 'returns complete Nashoptimal behavior strategies for each sequence For many '
 'of the information sets optimal play dictates taking a particular action '
 'with probability  For any such information set sequences later in the game '
 'that require the other action are reported as being played with the default '
 'probability  For example the optimal strategy in the  initial bucket case '
 'includes always checking in the ﬁrst betting round as player  Consequently '
 'any sequence in the second betting round that involves player  previously '
 'betting in the ﬁrst betting round are reported as  Since these later '
 'information sets will never be reached these values are irrelevant in our '
 'analysis The ﬁrst version of Simpliﬁed  Triple Draw that we developed '
 'involved combinations of  buckets for the ﬁrst round of betting '
 'transitioning to combinations of  buckets for the second round This is in '
 'contrast to the  and  initial bucket versions for which we present solutions '
 'in Chapter  The ',
 ' APPENDIX A GAMBIT bucket case is more complex with  information sets  '
 'sequences and  nodes Attempts to ﬁnd a Nash equilibrium for this game with '
 'Gambit return an unexplained error Direct correspondence with Gambit '
 'developer Theodore Turocy suggests that a solving a game of this size is '
 'infeasible in Gambits current version ',
 'Appendix B Simpliﬁed  Draw LP Results The following tables show the results '
 'of the Simpliﬁed  Draw sequence form LPs Each row denotes an information set '
 'for a particular player each of which has two possible actions The '
 'Information column denotes the previous action and information known to the '
 'player this describes the information set The PCFcolumn lists the '
 'probability that the optimal player should check or fold depending on '
 'context The PBCcolumn lists the corresponding probability that of the other '
 'action either betting or calling For example information set  for player  '
 'prescribes checking with probability  and betting with probability  given '
 'that player  initially had a hand in Bucket  then both players checked and '
 'now he has a hand in Bucket  Many of the information sets with optimal '
 'probabilities of  for each action is a history that the player will never '
 'face given the other prescriptions of strategy For example consider '
 'information set  for player  In the associated history player  bet after the '
 'initial deal since he always checks in the situation per information set  he '
 'will never face the choice of actions in ',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS information set  We denote these '
 'irrelevant sequences with Table  Optimal Realization Plan for  Initial '
 'Buckets Player Info Set Information PCF PBC   Deal to Bucket A     Bucket A  '
 'check  check Bucket     Bucket A  check  check Bucket   check      Bucket A  '
 'check  check Bucket     Bucket A  check  check Bucket   check      Bucket A  '
 'check  check Bucket     Bucket A  check  check Bucket   check  bet   Bucket '
 'A  check  bet     Bucket A  check  bet  call Bucket    continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket A  check  bet  call Bucket   check      Bucket A  check  bet  '
 'call Bucket     Bucket A  check  bet  call Bucket   check      Bucket A  '
 'check  bet  call Bucket     Bucket A  check  bet  call Bucket   check  bet   '
 'Bucket A  bet  call Bucket    Bucket A  bet  call Bucket   check  bet   '
 'Bucket A  bet  call Bucket    Bucket A  bet  call Bucket   check  bet  '
 'continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket A  bet  call Bucket    Bucket A  bet  call Bucket   check  '
 'bet   Deal to Bucket      Bucket B  check  check Bucket     Bucket B  check  '
 'check Bucket   check      Bucket B  check  check Bucket     Bucket B  check  '
 'check Bucket   check      Bucket B  check  check Bucket     Bucket B  check  '
 'check Bucket   check  bet   Bucket B  check  bet     Bucket B  check  bet  '
 'call Bucket    continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket B  check  bet  call Bucket   check  bet   Bucket B  check  bet  '
 'call Bucket     Bucket B  check  bet  call Bucket   check      Bucket B  '
 'check  bet  call Bucket     Bucket B  check  bet  call Bucket   check  bet   '
 'Bucket B  bet  call Bucket    Bucket B  bet  call Bucket   check  bet   '
 'Bucket B  bet  call Bucket    Bucket B  bet  call Bucket   check  bet  '
 'continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket B  bet  call Bucket    Bucket B  bet  call Bucket   check  '
 'bet   Bucket A  check     Bucket A  check  check Bucket       Bucket A  '
 'check  check Bucket       Bucket A  check  check Bucket       Bucket A  '
 'check  check Bucket       Bucket A  check  check Bucket       Bucket A  '
 'check  check Bucket       Bucket A  check  bet  call Bucket   check   Bucket '
 'A  check  bet  call Bucket   bet  continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket A  check  bet  call Bucket   check   Bucket A  check  bet  call '
 'Bucket   bet   Bucket A  check  bet  call Bucket   check   Bucket A  check  '
 'bet  call Bucket   bet   Bucket A  bet     Bucket A  bet  call Bucket       '
 'Bucket A  bet  call Bucket       Bucket A  bet  call Bucket       Bucket A  '
 'bet  call Bucket       Bucket A  bet  call Bucket       Bucket A  bet  call '
 'Bucket      continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket B  check     Bucket B  check  check Bucket   check   Bucket B  '
 'check  check Bucket   bet   Bucket B  check  check Bucket   check   Bucket '
 'B  check  check Bucket   bet   Bucket B  check  check Bucket   check   '
 'Bucket B  check  check Bucket   bet   Bucket B  check  bet  call '
 'Bucket       Bucket B  check  bet  call Bucket       Bucket B  check  bet  '
 'call Bucket       Bucket B  check  bet  call Bucket      continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket B  check  bet  call Bucket       Bucket B  check  bet  call '
 'Bucket       Bucket B  bet     Bucket B  bet  call Bucket       Bucket B  '
 'bet  call Bucket       Bucket B  bet  call Bucket       Bucket B  bet  call '
 'Bucket       Bucket B  bet  call Bucket       Bucket B  bet  call '
 'Bucket      continued While Table  describes cogent realization plans based '
 'on Gambits rational computation for the  initial bucket case Table  '
 'describes the raw results of Gambits nonrational computation of the  initial '
 'bucket case Due to numerical instabilities we strongly suspect that these '
 'results are incorrect',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Notice that the values do not '
 'describe probability distributions over each information set they sometimes '
 'do not sum to  are greater than  or less than  The values in Table  are '
 'unedited and directly reﬂect Gambits output We do not identify irrelevant '
 'sequences but these are likely to be information sets where both sequences '
 'are played with probability   Table  Optimal Realization Plan for  Initial '
 'Buckets Player Info Set Information PCF PBC   Deal to Bucket C     Bucket C  '
 'check  check Bucket     Bucket C  check  check Bucket   check      Bucket C  '
 'check  check Bucket     Bucket C  check  check Bucket   check      Bucket C  '
 'cheeck  check Bucket     Bucket C  check  check Bucket   check     continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket C  check  bet     Bucket C  check  bet  call Bucket     Bucket '
 'C  check  bet  call Bucket   check      Bucket C  check  bet  call '
 'Bucket     Bucket C  check  bet  call Bucket   check      Bucket C  check  '
 'bet  call Bucket     Bucket C  check  bet  call Bucket   check      Bucket '
 'C  bet  call Bucket     Bucket C  bet  call Bucket   check     continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket C  bet  call Bucket     Bucket C  bet  call Bucket   check      '
 'Bucket C  bet  call Bucket     Bucket C  bet  call Bucket   check      Deal '
 'to Bucket D     Bucket D  check  check Bucket     Bucket D  check  check '
 'Bucket   check      Bucket D  check  check Bucket     Bucket D  check  check '
 'Bucket   check      Bucket D  check  check Bucket     Bucket D  check  check '
 'Bucket   check     continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket D  check  bet     Bucket D  check  bet  call Bucket     Bucket '
 'D  check  bet  call Bucket   check      Bucket D  check  bet  call '
 'Bucket     Bucket D  check  bet  call Bucket   check      Bucket D  check  '
 'bet  call Bucket     Bucket D  check  bet  call Bucket   check      Bucket '
 'D  bet  call Bucket     Bucket D  bet  call Bucket   check     continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket D  bet  call Bucket     Bucket D  bet  call Bucket   check      '
 'Bucket D  bet  call Bucket     Bucket D  bet  call Bucket   check      Deal '
 'to Bucket E     Bucket E  check  check Bucket     Bucket E  check  check '
 'Bucket   check      Bucket E  check  check Bucket     Bucket E  check  check '
 'Bucket   check      Bucket E  check  check Bucket     Bucket E  check  check '
 'Bucket   check     continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket E  check  bet     Bucket E  check  bet  call Bucket     Bucket '
 'E  check  bet  call Bucket   check      Bucket E  check  bet  call '
 'Bucket     Bucket E  check  bet  call Bucket   check      Bucket E  check  '
 'bet  call Bucket     Bucket E  check  bet  call Bucket   check      Bucket '
 'E  bet  call Bucket     Bucket E  bet  call Bucket   check     continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket E  bet  call Bucket     Bucket E  bet  call Bucket   check      '
 'Bucket E  bet  call Bucket     Bucket E  bet  call Bucket   check      '
 'Bucket C  check     Bucket C  check  check Bucket       Bucket C  check  '
 'check Bucket       Bucket C  check  check Bucket       Bucket C  check  '
 'check Bucket       Bucket C  check  check Bucket       Bucket C  check  '
 'check Bucket      continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket C  check  bet  call Bucket       Bucket C  check  bet  call '
 'Bucket       Bucket C  check  bet  call Bucket       Bucket C  check  bet  '
 'call Bucket       Bucket C  check  bet  call Bucket       Bucket C  check  '
 'bet  call Bucket       Bucket C  bet     Bucket C  bet  call Bucket       '
 'Bucket C  bet  call Bucket       Bucket C  bet  call Bucket       Bucket C  '
 'bet  call Bucket      continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket C  bet  call Bucket       Bucket C  bet  call Bucket       '
 'Bucket D  check     Bucket D  check  check Bucket       Bucket D  check  '
 'check Bucket       Bucket D  check  check Bucket       Bucket D  check  '
 'check Bucket       Bucket D  check  check Bucket       Bucket D  check  '
 'check Bucket       Bucket D  check  bet  call Bucket       Bucket D  check  '
 'bet  call Bucket      continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket D  check  bet  call Bucket       Bucket D  check  bet  call '
 'Bucket       Bucket D  check  bet  call Bucket       Bucket D  check  bet  '
 'call Bucket       Bucket D  bet     Bucket D  bet  call Bucket       Bucket '
 'D  bet  call Bucket       Bucket D  bet  call Bucket       Bucket D  bet  '
 'call Bucket       Bucket D  bet  call Bucket       Bucket D  bet  call '
 'Bucket      continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS Player Info Set Information PCF '
 'PBC   Bucket E  check     Bucket E  check  check Bucket       Bucket E  '
 'check  check Bucket       Bucket E  check  check Bucket       Bucket E  '
 'check  check Bucket       Bucket E  check  check Bucket       Bucket E  '
 'check  check Bucket       Bucket E  check  bet  call Bucket       Bucket E  '
 'check  bet  call Bucket       Bucket E  check  bet  call Bucket       Bucket '
 'E  check  bet  call Bucket      continued',
 'APPENDIX B SIMPLIFIED  DRAW LP RESULTS  Player Info Set Information PCF '
 'PBC   Bucket E  check  bet  call Bucket       Bucket E  check  bet  call '
 'Bucket       Bucket E  bet     Bucket E  bet  call Bucket       Bucket E  '
 'bet  call Bucket       Bucket E  bet  call Bucket       Bucket E  bet  call '
 'Bucket       Bucket E  bet  call Bucket       Bucket E  bet  call '
 'Bucket      continued',
 ' APPENDIX B SIMPLIFIED  DRAW LP RESULTS',
 'Bibliography  Rickard Andersson PseudoOptimal Strategies in NoLimit Poker '
 'Masters thesis Umea University   D Billings N Burch A Davidson R Holte J '
 'Schae ﬀer T Schauenberg and D Szafron Approximating GameTheoretic Optimal '
 'Strategies for FullScale Poker Proceedings of the  International Joint '
 'Conference on Artiﬁcial Intelligence  University of Alberta  Michael Bowling '
 'Neil Burch Michael Johanson and Oskari Tammelin Headsup Limit Holdem Poker '
 'is Solved Science    Drew Fudenberg and Jean Tirole Game Theory '
 'Massachusetts Institute of Technology Boston MA   Harold W Kuhn '
 'Contributions to the Theory of Games pages  Princeton University Press   '
 'Richard D McKelvey Andrew M McLennan and Theodore L Turocy ',
 ' BIBLIOGRAPHY Gambit Software Tools for Game Theory Version   '
 'httpwwwgambitprojectorg  Martin J Osborne and Ariel Rubinstein A Course in '
 'Game Theory Massachusetts Institute of Technology Press   Pokerstars  Deuce '
 'to Seven Single Draw Lowball Rules  https wwwpokerstarscom poker games '
 'draw   Tuomas Sandholm and Andrew Gilpin Optimal Rhode Island Holdem Poker '
 'National Conference on Artiﬁcial Intelligence AAAI Intelligent Systems '
 'Demonstration Program   Byron Spice Carnegie Mellon Artiﬁcial Intelligence '
 'Beats Top Poker Pros  https wwwcmuedu news stories archives  AI '
 'beatspokerproshtml  Ted Turocy Personal correspondence Gambit Technical '
 'Support  https githubcom gambitproject gambit issues   Robert J Vanderbei '
 'Linear Programming Foundations and Extensions Springer US Boston MA   '
 'Bernhard von Stengel E ﬃcient Computation of Behavior Strategies Games and '
 'Economic Behavior  ']
